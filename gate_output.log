=== Gate Check: INVESTIGATED-FIXED ===
Task: BUG-065
Worktree: /Users/elliotmilco/Documents/GitHub/clams/.worktrees/BUG-065


--- Gate: Implementation code exists ---
✓ Implementation code exists: PASS
Changed files:
  tests/scripts/test_bug_065_regression.py

--- Gate: Regression test added ---
✓ Regression test added: PASS
Test files changed:
  tests/scripts/test_bug_065_regression.py

--- Gate: Tests pass ---
=== Running Tests ===
Directory: /Users/elliotmilco/Documents/GitHub/clams/.worktrees/BUG-065
Task ID: BUG-065

Detected: Python (pytest)

Syncing dependencies with uv...

Running tests (cleanup timeout: 30s)...
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-9.0.1, pluggy-1.6.0 -- /Users/elliotmilco/Documents/GitHub/clams/.worktrees/BUG-065/.venv/bin/python
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: /Users/elliotmilco/Documents/GitHub/clams/.worktrees/BUG-065
configfile: pyproject.toml
testpaths: tests
plugins: mock-3.15.1, hypothesis-6.148.6, anyio-4.12.0, asyncio-1.3.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 751 items / 56 deselected / 695 selected

tests/bugs/test_bug_041_searcher_inheritance.py::test_searcher_is_subclass_of_abc PASSED
tests/bugs/test_bug_041_searcher_inheritance.py::test_searcher_instance_is_abc_instance PASSED
tests/bugs/test_bug_041_searcher_inheritance.py::test_searcher_implements_all_abstract_methods PASSED
tests/bugs/test_bug_041_searcher_inheritance.py::test_context_assembler_accepts_concrete_searcher PASSED
tests/bugs/test_bug_041_searcher_inheritance.py::test_concrete_searcher_methods_are_callable PASSED
tests/bugs/test_bug_041_searcher_inheritance.py::test_abc_method_signatures_match_concrete PASSED
tests/clustering/test_bug_031_regression.py::test_clustering_forms_with_similar_embeddings PASSED
tests/clustering/test_bug_031_regression.py::test_old_parameters_would_fail PASSED
tests/clustering/test_clusterer.py::test_cluster_basic PASSED
tests/clustering/test_clusterer.py::test_cluster_with_weights PASSED
tests/clustering/test_clusterer.py::test_cluster_empty PASSED
tests/clustering/test_clusterer.py::test_cluster_wrong_shape PASSED
tests/clustering/test_clusterer.py::test_cluster_weights_mismatch PASSED
tests/clustering/test_clusterer.py::test_cluster_single_cluster PASSED
tests/clustering/test_clusterer.py::test_compute_centroids PASSED
tests/clustering/test_clusterer.py::test_compute_centroids_excludes_noise PASSED
tests/clustering/test_clusterer.py::test_compute_centroids_weighted PASSED
tests/clustering/test_clusterer.py::test_compute_centroids_array_mismatch PASSED
tests/clustering/test_clusterer.py::test_compute_centroids_weights_mismatch PASSED
tests/clustering/test_clusterer.py::test_compute_centroids_no_weights PASSED
tests/clustering/test_clusterer.py::test_cluster_invariants PASSED
tests/clustering/test_clusterer.py::test_centroid_invariants PASSED
tests/clustering/test_clusterer.py::test_cluster_result_types PASSED
tests/clustering/test_clusterer.py::test_cluster_info_types PASSED
tests/clustering/test_experience.py::test_cluster_axis_success 2025-12-14 12:58:25 [info     ] clustering.complete            axis=full n_clusters=2 noise_count=10 total_points=20
PASSED
tests/clustering/test_experience.py::test_cluster_axis_invalid PASSED
tests/clustering/test_experience.py::test_cluster_axis_no_data PASSED
tests/clustering/test_experience.py::test_cluster_axis_with_weights 2025-12-14 12:58:25 [info     ] clustering.complete            axis=strategy n_clusters=2 noise_count=10 total_points=20
PASSED
tests/clustering/test_experience.py::test_cluster_axis_missing_tier 2025-12-14 12:58:25 [info     ] clustering.complete            axis=full n_clusters=2 noise_count=10 total_points=20
PASSED
tests/clustering/test_experience.py::test_cluster_axis_all_noise 2025-12-14 12:58:25 [warning  ] clustering.all_noise           axis=full message='HDBSCAN labeled all points as noise - no clusters found' noise_count=5 total_points=5
PASSED
tests/clustering/test_experience.py::test_cluster_all_axes 2025-12-14 12:58:25 [warning  ] clustering.all_noise           axis=full message='HDBSCAN labeled all points as noise - no clusters found' noise_count=10 total_points=10
2025-12-14 12:58:25 [warning  ] clustering.all_noise           axis=strategy message='HDBSCAN labeled all points as noise - no clusters found' noise_count=15 total_points=15
2025-12-14 12:58:25 [warning  ] clustering.axis_skipped        axis=surprise error="No embeddings found for axis 'surprise' (collection: ghap_surprise)" message='Skipping axis due to error'
2025-12-14 12:58:25 [warning  ] clustering.axis_skipped        axis=root_cause error="No embeddings found for axis 'root_cause' (collection: ghap_root_cause)" message='Skipping axis due to error'
PASSED
tests/clustering/test_experience.py::test_cluster_all_axes_all_empty 2025-12-14 12:58:25 [warning  ] clustering.axis_skipped        axis=full error="No embeddings found for axis 'full' (collection: ghap_full)" message='Skipping axis due to error'
2025-12-14 12:58:25 [warning  ] clustering.axis_skipped        axis=strategy error="No embeddings found for axis 'strategy' (collection: ghap_strategy)" message='Skipping axis due to error'
2025-12-14 12:58:25 [warning  ] clustering.axis_skipped        axis=surprise error="No embeddings found for axis 'surprise' (collection: ghap_surprise)" message='Skipping axis due to error'
2025-12-14 12:58:25 [warning  ] clustering.axis_skipped        axis=root_cause error="No embeddings found for axis 'root_cause' (collection: ghap_root_cause)" message='Skipping axis due to error'
PASSED
tests/clustering/test_experience.py::test_cluster_axis_calls_correct_collection 2025-12-14 12:58:25 [info     ] clustering.complete            axis=full n_clusters=2 noise_count=10 total_points=20
2025-12-14 12:58:25 [info     ] clustering.complete            axis=strategy n_clusters=2 noise_count=10 total_points=20
2025-12-14 12:58:25 [info     ] clustering.complete            axis=surprise n_clusters=2 noise_count=10 total_points=20
2025-12-14 12:58:25 [info     ] clustering.complete            axis=root_cause n_clusters=2 noise_count=10 total_points=20
PASSED
tests/clustering/test_experience.py::test_cluster_axis_scroll_limit_warning 2025-12-14 12:58:25 [warning  ] clustering.scroll_limit_reached axis=full collection=ghap_full count=10000 message='May have truncated results - consider pagination'
2025-12-14 12:58:35 [info     ] clustering.complete            axis=full n_clusters=358 noise_count=8166 total_points=10000
PASSED
tests/clustering/test_types.py::test_confidence_weights_mapping PASSED
tests/clustering/test_types.py::test_get_weight_valid_tiers PASSED
tests/clustering/test_types.py::test_get_weight_case_insensitive PASSED
tests/clustering/test_types.py::test_get_weight_none PASSED
tests/clustering/test_types.py::test_get_weight_invalid PASSED
tests/context/test_assembler.py::test_assemble_single_source_memories 2025-12-14 12:58:35 [info     ] assembling_context             component=context_assembler context_types=['memories'] limit=20 max_tokens=1000 query='coding preferences'
2025-12-14 12:58:35 [info     ] deduplication_complete         component=context_assembler deduplicated_count=1 original_count=1
2025-12-14 12:58:35 [debug    ] source_budget_used             budget=1000 component=context_assembler items_selected=1 source=memories unused=983 used=17
2025-12-14 12:58:35 [debug    ] redistributing_unused_budget   component=context_assembler total_unused=983
PASSED
tests/context/test_assembler.py::test_assemble_multiple_sources 2025-12-14 12:58:35 [info     ] assembling_context             component=context_assembler context_types=['memories', 'code'] limit=20 max_tokens=2000 query='python examples'
2025-12-14 12:58:35 [info     ] deduplication_complete         component=context_assembler deduplicated_count=2 original_count=2
2025-12-14 12:58:35 [debug    ] source_budget_used             budget=666 component=context_assembler items_selected=1 source=memories unused=649 used=17
2025-12-14 12:58:35 [debug    ] source_budget_used             budget=1333 component=context_assembler items_selected=1 source=code unused=1308 used=25
2025-12-14 12:58:35 [debug    ] redistributing_unused_budget   component=context_assembler total_unused=1957
PASSED
tests/context/test_assembler.py::test_invalid_context_type PASSED
tests/context/test_assembler.py::test_empty_results 2025-12-14 12:58:35 [info     ] assembling_context             component=context_assembler context_types=['memories', 'code'] limit=20 max_tokens=1000 query=nothing
2025-12-14 12:58:35 [info     ] deduplication_complete         component=context_assembler deduplicated_count=0 original_count=0
PASSED
tests/context/test_assembler.py::test_token_budget_distribution 2025-12-14 12:58:35 [info     ] assembling_context             component=context_assembler context_types=['memories'] limit=20 max_tokens=500 query=test
2025-12-14 12:58:35 [info     ] deduplication_complete         component=context_assembler deduplicated_count=8 original_count=8
2025-12-14 12:58:35 [debug    ] source_budget_used             budget=500 component=context_assembler items_selected=8 source=memories unused=354 used=146
2025-12-14 12:58:35 [debug    ] redistributing_unused_budget   component=context_assembler total_unused=354
PASSED
tests/context/test_assembler.py::test_deduplication 2025-12-14 12:58:35 [info     ] assembling_context             component=context_assembler context_types=['experiences', 'values'] limit=20 max_tokens=2000 query=test
2025-12-14 12:58:35 [info     ] deduplication_complete         component=context_assembler deduplicated_count=1 original_count=2
2025-12-14 12:58:35 [debug    ] source_budget_used             budget=500 component=context_assembler items_selected=1 source=values unused=487 used=13
2025-12-14 12:58:35 [debug    ] redistributing_unused_budget   component=context_assembler total_unused=487
PASSED
tests/context/test_assembler.py::test_premortem_context 2025-12-14 12:58:35 [info     ] assembling_premortem           component=context_assembler domain=debugging limit=10 strategy=systematic
PASSED
tests/context/test_assembler.py::test_premortem_partial_failure 2025-12-14 12:58:35 [info     ] assembling_premortem           component=context_assembler domain=debugging limit=10 strategy=None
2025-12-14 12:58:35 [warning  ] premortem_query_partial_failure component=context_assembler error='Surprise axis failed' query_index=1
PASSED
tests/context/test_assembler.py::test_partial_source_failure 2025-12-14 12:58:35 [info     ] assembling_context             component=context_assembler context_types=['memories', 'code'] limit=20 max_tokens=2000 query=test
2025-12-14 12:58:35 [warning  ] source_query_partial_failure   component=context_assembler error='Code search failed' source=code
2025-12-14 12:58:35 [info     ] deduplication_complete         component=context_assembler deduplicated_count=1 original_count=1
2025-12-14 12:58:35 [debug    ] source_budget_used             budget=666 component=context_assembler items_selected=1 source=memories unused=652 used=14
2025-12-14 12:58:35 [debug    ] redistributing_unused_budget   component=context_assembler total_unused=652
PASSED
tests/context/test_bug_036_regression.py::test_bug_036_invalid_context_type PASSED
tests/context/test_bug_036_regression.py::test_bug_036_multiple_invalid_types PASSED
tests/context/test_bug_036_regression.py::test_bug_036_mixed_valid_and_invalid PASSED
tests/context/test_bug_036_regression.py::test_bug_036_error_shows_valid_types PASSED
tests/context/test_bug_040_type_consistency.py::TestFormatCodeWithCanonicalType::test_format_code_uses_line_start PASSED
tests/context/test_bug_040_type_consistency.py::TestFormatCodeWithCanonicalType::test_format_code_no_keyerror PASSED
tests/context/test_bug_040_type_consistency.py::TestFormatExperienceWithCanonicalType::test_format_experience_with_lesson_dataclass PASSED
tests/context/test_bug_040_type_consistency.py::TestFormatExperienceWithCanonicalType::test_format_experience_with_root_cause_dataclass PASSED
tests/context/test_bug_040_type_consistency.py::TestFormatExperienceWithCanonicalType::test_format_experience_no_attributeerror PASSED
tests/context/test_bug_040_type_consistency.py::TestFormatValueWithCanonicalType::test_format_value_uses_member_count PASSED
tests/context/test_bug_040_type_consistency.py::TestFormatValueWithCanonicalType::test_format_value_no_keyerror PASSED
tests/context/test_bug_040_type_consistency.py::TestFormatMemoryWithCanonicalType::test_format_memory_with_importance PASSED
tests/context/test_bug_040_type_consistency.py::TestFormatMemoryWithCanonicalType::test_format_memory_no_keyerror PASSED
tests/context/test_bug_040_type_consistency.py::TestTypeConsistency::test_searcher_types_reexports_canonical_types PASSED
tests/context/test_bug_040_type_consistency.py::TestTypeConsistency::test_no_duplicate_definitions PASSED
tests/context/test_deduplication.py::test_deduplicate_items_empty PASSED
tests/context/test_deduplication.py::test_deduplicate_items_no_duplicates PASSED
tests/context/test_deduplication.py::test_deduplicate_items_by_ghap_id PASSED
tests/context/test_deduplication.py::test_deduplicate_items_by_file_path PASSED
tests/context/test_deduplication.py::test_deduplicate_items_by_sha PASSED
tests/context/test_deduplication.py::test_deduplicate_items_by_memory_id PASSED
tests/context/test_deduplication.py::test_deduplicate_items_fuzzy_match PASSED
tests/context/test_deduplication.py::test_deduplicate_items_fuzzy_no_match PASSED
tests/context/test_deduplication.py::test_deduplicate_items_sorted_by_relevance PASSED
tests/context/test_deduplication.py::test_deduplicate_items_skips_long_content PASSED
tests/context/test_formatting.py::test_format_memory PASSED
tests/context/test_formatting.py::test_format_code PASSED
tests/context/test_formatting.py::test_format_code_no_docstring PASSED
tests/context/test_formatting.py::test_format_experience PASSED
tests/context/test_formatting.py::test_format_experience_no_optional_fields PASSED
tests/context/test_formatting.py::test_format_value PASSED
tests/context/test_formatting.py::test_format_commit PASSED
tests/context/test_formatting.py::test_format_commit_many_files PASSED
tests/context/test_formatting.py::test_assemble_markdown_standard PASSED
tests/context/test_formatting.py::test_assemble_markdown_empty_sources PASSED
tests/context/test_formatting.py::test_assemble_markdown_premortem PASSED
tests/context/test_formatting.py::test_assemble_markdown_premortem_no_strategy PASSED
tests/context/test_tokens.py::test_estimate_tokens_basic PASSED
tests/context/test_tokens.py::test_estimate_tokens_empty PASSED
tests/context/test_tokens.py::test_truncate_to_tokens_no_truncation PASSED
tests/context/test_tokens.py::test_truncate_to_tokens_truncates PASSED
tests/context/test_tokens.py::test_truncate_to_tokens_prefers_newline PASSED
tests/context/test_tokens.py::test_distribute_budget_single_source PASSED
tests/context/test_tokens.py::test_distribute_budget_multiple_sources PASSED
tests/context/test_tokens.py::test_distribute_budget_all_sources PASSED
tests/context/test_tokens.py::test_cap_item_tokens_no_cap PASSED
tests/context/test_tokens.py::test_cap_item_tokens_applies_cap PASSED
tests/context/test_tokens.py::test_cap_item_tokens_code_note PASSED
tests/context/test_tokens.py::test_cap_item_tokens_experience_note PASSED
tests/embedding/test_bug_014_mps_workaround.py::test_bug_014_embedding_model_uses_cpu_on_mps PASSED
tests/embedding/test_bug_014_mps_workaround.py::test_bug_014_batch_encoding_performance PASSED
tests/embedding/test_minilm.py::test_embed_single_text PASSED
tests/embedding/test_minilm.py::test_embed_batch PASSED
tests/embedding/test_minilm.py::test_embed_empty_batch PASSED
tests/embedding/test_minilm.py::test_dimension_property PASSED
tests/embedding/test_minilm.py::test_mps_fallback_to_cpu PASSED
tests/embedding/test_minilm.py::test_semantic_similarity PASSED
tests/embedding/test_minilm.py::test_invalid_model_name PASSED
tests/embedding/test_minilm.py::test_embed_error_handling PASSED
tests/embedding/test_minilm.py::test_batch_embed_error_handling PASSED
tests/embedding/test_minilm.py::test_embedding_consistency PASSED
tests/embedding/test_minilm.py::test_batch_vs_single_consistency PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_dimension PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_returns_correct_shape PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_deterministic PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_different_texts_produce_different_embeddings PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_normalized PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_batch_empty_list PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_batch_single_item PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_batch_multiple_items PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_batch_consistency_with_embed PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_handles_special_characters PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_long_text PASSED
tests/embedding/test_registry.py::test_registry_not_initialized PASSED
tests/embedding/test_registry.py::test_registry_initialization PASSED
tests/embedding/test_registry.py::test_lazy_loading_code_embedder 2025-12-14 12:58:50 [info     ] code_embedder.loaded           dimension=384 model=sentence-transformers/all-MiniLM-L6-v2
PASSED
tests/embedding/test_registry.py::test_lazy_loading_semantic_embedder 2025-12-14 12:58:53 [info     ] semantic_embedder.loaded       dimension=768 model=nomic-ai/nomic-embed-text-v1.5
PASSED
tests/embedding/test_registry.py::test_instance_caching 2025-12-14 12:58:54 [info     ] code_embedder.loaded           dimension=384 model=sentence-transformers/all-MiniLM-L6-v2
2025-12-14 12:58:56 [info     ] semantic_embedder.loaded       dimension=768 model=nomic-ai/nomic-embed-text-v1.5
PASSED
tests/embedding/test_registry.py::test_env_var_override_code_model PASSED
tests/embedding/test_registry.py::test_env_var_override_semantic_model PASSED
tests/embedding/test_registry.py::test_registry_separate_instances 2025-12-14 12:58:57 [info     ] code_embedder.loaded           dimension=384 model=sentence-transformers/all-MiniLM-L6-v2
2025-12-14 12:59:00 [info     ] semantic_embedder.loaded       dimension=768 model=nomic-ai/nomic-embed-text-v1.5
PASSED
tests/embedding/test_registry.py::test_registry_model_logging PASSED
tests/embedding/test_registry.py::test_direct_registry_usage PASSED
tests/gates/test_check_types.py::test_check_types_completes_standalone PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_initial PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_incremental PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_already_up_to_date PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_force_reindex PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_with_limit PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_five_year_limit PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_search_commits PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_search_commits_with_author_filter PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_search_commits_with_date_filter PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_get_churn_hotspots PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_get_file_authors PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_get_change_frequency PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_get_change_frequency_nonexistent_file PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_blame_search PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_blame_search_with_file_pattern PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_embedding_text_format PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_embedding_text_truncation PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_state_tracking PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_batch_embedding_performance PASSED
tests/git/test_analyzer.py::test_integration_with_real_repo PASSED
tests/git/test_reader.py::TestGitPythonReader::test_init_with_valid_repo PASSED
tests/git/test_reader.py::TestGitPythonReader::test_init_with_invalid_repo PASSED
tests/git/test_reader.py::TestGitPythonReader::test_init_with_nonexistent_path PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_empty_repo PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_single_commit PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_multiple_commits PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_with_limit PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_with_path_filter PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_with_date_filter PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_blame_text_file PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_blame_nonexistent_file PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_blame_binary_file PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_file_history PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_head_sha PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_head_sha_empty_repo PASSED
tests/git/test_reader.py::TestGitPythonReader::test_commit_timezone_aware PASSED
tests/git/test_reader.py::TestGitPythonReader::test_blame_timezone_aware PASSED
tests/git/test_reader.py::TestGitPythonReader::test_files_changed_relative_paths PASSED
tests/git/test_reader.py::test_integration_with_real_repo PASSED
tests/hooks/test_bug_033_regression.py::TestBug033Regression::test_server_command_uses_venv_binary PASSED
tests/hooks/test_bug_033_regression.py::TestBug033Regression::test_server_command_path_is_absolute PASSED
tests/hooks/test_bug_033_regression.py::TestBug033Regression::test_config_yaml_uses_correct_command PASSED
tests/hooks/test_bug_050_regression.py::test_bug_050_session_start_hook_output_schema PASSED
tests/hooks/test_bug_050_regression.py::test_bug_050_no_legacy_schema_fields PASSED
tests/hooks/test_bug_050_regression.py::test_bug_050_ghap_instructions_present PASSED
tests/hooks/test_bug_051_regression.py::TestBug051Regression::test_bug_051_user_prompt_submit_hook_output_schema PASSED
tests/hooks/test_bug_051_regression.py::TestBug051Regression::test_bug_051_no_legacy_schema_fields PASSED
tests/hooks/test_bug_051_regression.py::TestBug051Regression::test_bug_051_source_contains_correct_schema PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_init PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_connect_success PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_connect_timeout PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_connect_exception PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_not_connected PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_success PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_empty_content PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_invalid_json PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_timeout PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_exception PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_close_with_session PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_close_without_session PASSED
tests/hooks/test_mcp_client.py::TestMainCLI::test_main_invalid_args PASSED
tests/hooks/test_mcp_client.py::TestMainCLI::test_main_invalid_json_args PASSED
tests/hooks/test_mcp_client.py::TestMainCLI::test_main_connection_failed PASSED
tests/hooks/test_mcp_client.py::TestMainCLI::test_main_success PASSED
tests/indexers/test_bug_003_regression.py::test_bug_003_double_index_inmemory PASSED
tests/indexers/test_bug_003_regression.py::test_bug_003_double_index_with_modification PASSED
tests/indexers/test_bug_003_regression.py::test_bug_003_multiple_projects_same_collection PASSED
tests/indexers/test_bug_012_exclusions.py::test_bug_012_default_exclusions_prevent_venv_indexing PASSED
tests/indexers/test_bug_012_exclusions.py::test_bug_012_indexing_completes_in_reasonable_time PASSED
tests/indexers/test_indexer.py::test_index_single_file PASSED
tests/indexers/test_indexer.py::test_index_file_twice_skips_second PASSED
tests/indexers/test_indexer.py::test_index_directory PASSED
tests/indexers/test_indexer.py::test_remove_file PASSED
tests/indexers/test_indexer.py::test_remove_project PASSED
tests/indexers/test_indexer.py::test_reindex_prevents_orphans PASSED
tests/indexers/test_indexer.py::test_empty_file_handling PASSED
tests/indexers/test_indexer.py::test_error_accumulation PASSED
tests/indexers/test_indexer.py::test_exclude_patterns PASSED
tests/indexers/test_indexer.py::test_get_indexing_stats PASSED
tests/indexers/test_indexer.py::test_dimension_migration PASSED
tests/indexers/test_tree_sitter.py::test_language_detection PASSED
tests/indexers/test_tree_sitter.py::test_supported_languages PASSED
tests/indexers/test_tree_sitter.py::test_parse_python PASSED
tests/indexers/test_tree_sitter.py::test_parse_typescript PASSED
tests/indexers/test_tree_sitter.py::test_parse_javascript PASSED
tests/indexers/test_tree_sitter.py::test_parse_rust PASSED
tests/indexers/test_tree_sitter.py::test_parse_java PASSED
tests/indexers/test_tree_sitter.py::test_parse_c PASSED
tests/indexers/test_tree_sitter.py::test_parse_cpp PASSED
tests/indexers/test_tree_sitter.py::test_parse_swift PASSED
tests/indexers/test_tree_sitter.py::test_parse_empty_file PASSED
tests/indexers/test_tree_sitter.py::test_parse_malformed_file PASSED
tests/observation/test_collector.py::test_create_ghap PASSED
tests/observation/test_collector.py::test_create_ghap_auto_starts_session PASSED
tests/observation/test_collector.py::test_create_ghap_when_active_raises PASSED
tests/observation/test_collector.py::test_update_ghap_changes_hypothesis PASSED
tests/observation/test_collector.py::test_update_ghap_changes_all_hap PASSED
tests/observation/test_collector.py::test_update_ghap_note_only PASSED
tests/observation/test_collector.py::test_update_ghap_strategy_only PASSED
tests/observation/test_collector.py::test_update_ghap_no_active_raises PASSED
tests/observation/test_collector.py::test_resolve_ghap_confirmed PASSED
tests/observation/test_collector.py::test_resolve_ghap_auto_captured_gold PASSED
tests/observation/test_collector.py::test_abandon_ghap PASSED
tests/observation/test_collector.py::test_start_session PASSED
tests/observation/test_collector.py::test_start_session_archives_previous PASSED
tests/observation/test_collector.py::test_end_session PASSED
tests/observation/test_collector.py::test_end_session_abandons_current PASSED
tests/observation/test_collector.py::test_has_orphaned_entry PASSED
tests/observation/test_collector.py::test_adopt_orphan PASSED
tests/observation/test_collector.py::test_abandon_orphan PASSED
tests/observation/test_collector.py::test_increment_tool_count PASSED
tests/observation/test_collector.py::test_should_check_in PASSED
tests/observation/test_collector.py::test_reset_tool_count PASSED
tests/observation/test_collector.py::test_tool_count_persists PASSED
tests/observation/test_collector.py::test_full_session_lifecycle PASSED
tests/observation/test_collector.py::test_state_survives_restart PASSED
tests/observation/test_collector.py::test_multiple_iterations PASSED
tests/observation/test_collector.py::test_text_truncation PASSED
tests/observation/test_collector.py::test_corrupted_current_ghap_recovery PASSED
tests/observation/test_collector.py::test_corrupted_session_entries_recovery PASSED
tests/observation/test_models.py::test_root_cause_serialization PASSED
tests/observation/test_models.py::test_lesson_serialization PASSED
tests/observation/test_models.py::test_lesson_optional_takeaway PASSED
tests/observation/test_models.py::test_history_entry_serialization PASSED
tests/observation/test_models.py::test_outcome_serialization PASSED
tests/observation/test_models.py::test_ghap_entry_minimal_serialization PASSED
tests/observation/test_models.py::test_ghap_entry_full_serialization PASSED
tests/observation/test_models.py::test_domain_enum_values PASSED
tests/observation/test_models.py::test_strategy_enum_values PASSED
tests/observation/test_models.py::test_outcome_status_enum_values PASSED
tests/observation/test_models.py::test_confidence_tier_enum_values PASSED
tests/observation/test_persister.py::test_render_full_axis_with_all_fields PASSED
tests/observation/test_persister.py::test_render_full_axis_without_optional_fields PASSED
tests/observation/test_persister.py::test_render_strategy_axis PASSED
tests/observation/test_persister.py::test_render_surprise_axis PASSED
tests/observation/test_persister.py::test_render_root_cause_axis PASSED
tests/observation/test_persister.py::test_build_metadata_structure PASSED
tests/observation/test_persister.py::test_metadata_timestamp_conversion PASSED
tests/observation/test_persister.py::test_axis_specific_metadata PASSED
tests/observation/test_persister.py::test_confirmed_entry_gets_full_and_strategy_only PASSED
tests/observation/test_persister.py::test_falsified_entry_with_surprise_gets_all_axes PASSED
tests/observation/test_persister.py::test_falsified_without_surprise_skips_surprise_axis PASSED
tests/observation/test_persister.py::test_render_with_empty_string_vs_none PASSED
tests/observation/test_persister.py::test_entry_with_no_confidence_tier PASSED
tests/observation/test_persister.py::test_unicode_emoji_in_fields PASSED
tests/observation/test_persister.py::test_very_long_field_values PASSED
tests/observation/test_persister.py::test_special_regex_chars_in_field_values PASSED
tests/observation/test_persister.py::test_all_confidence_tier_values PASSED
tests/observation/test_persister.py::test_literal_template_syntax_in_fields PASSED
tests/observation/test_persister.py::test_root_cause_without_surprise PASSED
tests/observation/test_persister.py::test_persist_confirmed_entry PASSED
tests/observation/test_persister.py::test_persist_falsified_entry_with_surprise PASSED
tests/observation/test_persister.py::test_persist_batch PASSED
tests/observation/test_persister.py::test_persist_without_outcome_raises PASSED
tests/observation/test_persister.py::test_ensure_collections_creates_all PASSED
tests/observation/test_persister.py::test_ensure_collections_idempotent PASSED
tests/observation/test_persister.py::test_embedding_failure_propagates PASSED
tests/observation/test_persister.py::test_storage_failure_propagates PASSED
tests/observation/test_persister.py::test_batch_fails_on_first_invalid_entry PASSED
tests/observation/test_utils.py::test_generate_ghap_id PASSED
tests/observation/test_utils.py::test_generate_ghap_id_uniqueness PASSED
tests/observation/test_utils.py::test_generate_session_id PASSED
tests/observation/test_utils.py::test_generate_session_id_uniqueness PASSED
tests/observation/test_utils.py::test_compute_confidence_tier_abandoned PASSED
tests/observation/test_utils.py::test_compute_confidence_tier_gold PASSED
tests/observation/test_utils.py::test_compute_confidence_tier_silver PASSED
tests/observation/test_utils.py::test_compute_confidence_tier_no_outcome PASSED
tests/observation/test_utils.py::test_atomic_write PASSED
tests/observation/test_utils.py::test_atomic_write_overwrites_existing PASSED
tests/observation/test_utils.py::test_atomic_write_cleans_up_temp_on_error PASSED
tests/observation/test_utils.py::test_truncate_text_short PASSED
tests/observation/test_utils.py::test_truncate_text_exact_limit PASSED
tests/observation/test_utils.py::test_truncate_text_too_long PASSED
tests/observation/test_utils.py::test_truncate_text_unicode PASSED
tests/scripts/test_bug_037_verify_timeout.py::TestBug037Regression::test_verify_install_timeout_is_sufficient PASSED
tests/scripts/test_bug_037_verify_timeout.py::TestBug037Regression::test_verify_install_uses_subprocess_timeout PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_get_next_action_function_exists PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_describe_next_action_function_exists PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_generate_next_commands_function_exists PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_next_commands_subcommand_in_case_statement PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_next_commands_in_usage PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_bug_phases_have_actions PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_feature_phases_have_actions PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_investigated_phase_has_gate_check PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_implement_phase_has_gate_check PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_merge_command_for_integrate_phase PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_claws_status_calls_next_commands PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_next_commands_displayed_prominently PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_pending_actions_section_exists PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_code_block_in_next_commands PASSED
tests/scripts/test_bug_065_regression.py::TestBug065Regression::test_task_show_command_included PASSED
tests/search/test_results.py::TestMemoryResult::test_from_search_result_with_all_fields PASSED
tests/search/test_results.py::TestMemoryResult::test_from_search_result_with_optional_fields_none PASSED
tests/search/test_results.py::TestCodeResult::test_from_search_result_with_all_fields PASSED
tests/search/test_results.py::TestCodeResult::test_from_search_result_without_docstring PASSED
tests/search/test_results.py::TestExperienceResult::test_from_search_result_with_all_fields PASSED
tests/search/test_results.py::TestExperienceResult::test_from_search_result_without_optional_nested_objects PASSED
tests/search/test_results.py::TestValueResult::test_from_search_result PASSED
tests/search/test_results.py::TestCommitResult::test_from_search_result PASSED
tests/search/test_searcher.py::TestSearchMemories::test_calls_embed_with_query PASSED
tests/search/test_searcher.py::TestSearchMemories::test_calls_vector_store_with_correct_collection PASSED
tests/search/test_searcher.py::TestSearchMemories::test_applies_category_filter PASSED
tests/search/test_searcher.py::TestSearchMemories::test_empty_query_returns_empty_list PASSED
tests/search/test_searcher.py::TestSearchMemories::test_invalid_search_mode_raises_error PASSED
tests/search/test_searcher.py::TestSearchMemories::test_embedding_failure_raises_embedding_error PASSED
tests/search/test_searcher.py::TestSearchMemories::test_collection_not_found_raises_error PASSED
tests/search/test_searcher.py::TestSearchMemories::test_maps_results_correctly PASSED
tests/search/test_searcher.py::TestSearchCode::test_calls_embed_with_query PASSED
tests/search/test_searcher.py::TestSearchCode::test_calls_vector_store_with_correct_collection PASSED
tests/search/test_searcher.py::TestSearchCode::test_applies_multiple_filters PASSED
tests/search/test_searcher.py::TestSearchCode::test_maps_results_correctly PASSED
tests/search/test_searcher.py::TestSearchExperiences::test_calls_embed_with_query PASSED
tests/search/test_searcher.py::TestSearchExperiences::test_selects_correct_collection_for_axis PASSED
tests/search/test_searcher.py::TestSearchExperiences::test_invalid_axis_raises_error PASSED
tests/search/test_searcher.py::TestSearchExperiences::test_applies_domain_and_outcome_filters PASSED
tests/search/test_searcher.py::TestSearchExperiences::test_maps_results_with_nested_dataclasses PASSED
tests/search/test_searcher.py::TestSearchValues::test_calls_embed_with_query PASSED
tests/search/test_searcher.py::TestSearchValues::test_calls_vector_store_with_correct_collection PASSED
tests/search/test_searcher.py::TestSearchValues::test_default_limit_is_5 PASSED
tests/search/test_searcher.py::TestSearchValues::test_maps_results_correctly PASSED
tests/search/test_searcher.py::TestSearchCommits::test_calls_embed_with_query PASSED
tests/search/test_searcher.py::TestSearchCommits::test_calls_vector_store_with_correct_collection PASSED
tests/search/test_searcher.py::TestSearchCommits::test_applies_author_and_date_filters PASSED
tests/search/test_searcher.py::TestSearchCommits::test_maps_results_correctly PASSED
tests/search/test_searcher.py::TestCollectionName::test_experience_axis_mapping PASSED
tests/search/test_searcher.py::TestCollectionName::test_invalid_axis_raises_error PASSED
tests/server/test_bug_042_regression.py::test_bug_042_main_module_no_torch_at_import PASSED
tests/server/test_bug_042_regression.py::test_bug_042_parse_args_no_heavy_imports PASSED
tests/server/test_bug_042_regression.py::test_bug_042_daemon_start_does_not_crash PASSED
tests/server/test_bug_043_regression.py::TestBug043MemoriesCollection::test_store_memory_creates_collection PASSED
tests/server/test_bug_043_regression.py::TestBug043MemoriesCollection::test_retrieve_memories_creates_collection PASSED
tests/server/test_bug_043_regression.py::TestBug043MemoriesCollection::test_list_memories_creates_collection PASSED
tests/server/test_bug_043_regression.py::TestBug043MemoriesCollection::test_collection_created_only_once PASSED
tests/server/test_bug_043_regression.py::TestBug043MemoriesCollection::test_handles_already_exists_error PASSED
tests/server/test_bug_043_regression.py::TestBug043MemoriesCollection::test_handles_409_error PASSED
tests/server/test_bug_043_regression.py::TestBug043CommitsCollection::test_index_commits_creates_collection PASSED
tests/server/test_bug_043_regression.py::TestBug043CommitsCollection::test_search_commits_creates_collection PASSED
tests/server/test_bug_043_regression.py::TestBug043ValuesCollection::test_store_value_creates_collection PASSED
tests/server/test_bug_043_regression.py::TestBug043ValuesCollection::test_list_values_creates_collection PASSED
tests/server/test_config.py::test_default_settings PASSED
tests/server/test_config.py::test_env_override PASSED
tests/server/test_config.py::test_settings_immutable PASSED
tests/server/test_context_tools.py::TestAssembleContext::test_returns_empty_when_no_data PASSED
tests/server/test_context_tools.py::TestAssembleContext::test_includes_values_in_context PASSED
tests/server/test_context_tools.py::TestAssembleContext::test_includes_experiences_in_context PASSED
tests/server/test_context_tools.py::TestAssembleContext::test_includes_both_by_default PASSED
tests/server/test_context_tools.py::TestAssembleContext::test_respects_limit_parameter_for_values PASSED
tests/server/test_context_tools.py::TestAssembleContext::test_limits_experiences_to_5 PASSED
tests/server/test_context_tools.py::TestAssembleContext::test_calculates_token_count PASSED
tests/server/test_context_tools.py::TestAssembleContext::test_reports_truncation PASSED
tests/server/test_context_tools.py::TestAssembleContext::test_handles_value_store_error PASSED
tests/server/test_context_tools.py::TestAssembleContext::test_handles_searcher_error PASSED
tests/server/test_context_tools.py::TestAssembleContext::test_skips_experiences_without_query PASSED
tests/server/test_http.py::TestHttpServerCreation::test_http_server_init PASSED
tests/server/test_http.py::TestHttpServerCreation::test_http_server_creates_sse_transport PASSED
tests/server/test_http.py::TestHttpServerApp::test_create_app_handles_routes PASSED
tests/server/test_http.py::TestHealthEndpoint::test_health_returns_healthy PASSED
tests/server/test_http.py::TestApiCallEndpoint::test_api_call_invokes_tool PASSED
tests/server/test_http.py::TestApiCallEndpoint::test_api_call_unknown_tool PASSED
tests/server/test_http.py::TestApiCallEndpoint::test_api_call_missing_tool_name PASSED
tests/server/test_http.py::TestApiCallEndpoint::test_api_call_returns_dict PASSED
tests/server/test_http.py::TestDaemonManagement::test_get_pid_file_default PASSED
tests/server/test_http.py::TestDaemonManagement::test_get_pid_file_from_env PASSED
tests/server/test_http.py::TestDaemonManagement::test_is_server_running_no_pid_file PASSED
tests/server/test_http.py::TestDaemonManagement::test_is_server_running_stale_pid PASSED
tests/server/test_main.py::test_registry_provides_embedder PASSED
tests/server/test_main.py::test_create_server PASSED
tests/server/test_main.py::test_server_has_ping_tool PASSED
tests/server/test_session_tools.py::TestSessionManager::test_init_creates_manager PASSED
tests/server/test_session_tools.py::TestSessionManager::test_load_tool_count_from_file PASSED
tests/server/test_session_tools.py::TestSessionManager::test_load_tool_count_invalid_file PASSED
tests/server/test_session_tools.py::TestSessionManager::test_save_tool_count PASSED
tests/server/test_session_tools.py::TestSessionManager::test_get_current_session_id PASSED
tests/server/test_session_tools.py::TestSessionManager::test_get_current_session_id_no_file PASSED
tests/server/test_session_tools.py::TestStartSession::test_creates_session_id PASSED
tests/server/test_session_tools.py::TestStartSession::test_writes_session_id_file PASSED
tests/server/test_session_tools.py::TestStartSession::test_resets_tool_count PASSED
tests/server/test_session_tools.py::TestStartSession::test_returns_timestamp PASSED
tests/server/test_session_tools.py::TestGetOrphanedGhap::test_no_orphan_when_no_ghap_file PASSED
tests/server/test_session_tools.py::TestGetOrphanedGhap::test_no_orphan_when_same_session PASSED
tests/server/test_session_tools.py::TestGetOrphanedGhap::test_orphan_detected_for_different_session PASSED
tests/server/test_session_tools.py::TestShouldCheckIn::test_returns_false_when_count_low PASSED
tests/server/test_session_tools.py::TestShouldCheckIn::test_returns_true_when_count_equals_frequency PASSED
tests/server/test_session_tools.py::TestShouldCheckIn::test_returns_true_when_count_exceeds_frequency PASSED
tests/server/test_session_tools.py::TestShouldCheckIn::test_uses_default_frequency PASSED
tests/server/test_session_tools.py::TestIncrementToolCount::test_increments_count PASSED
tests/server/test_session_tools.py::TestIncrementToolCount::test_persists_to_file PASSED
tests/server/test_session_tools.py::TestResetToolCount::test_resets_count_to_zero PASSED
tests/server/test_session_tools.py::TestResetToolCount::test_persists_to_file PASSED
tests/server/tools/test_bug_005_clusterer_initialization.py::test_clusterer_has_correct_default_parameters PASSED
tests/server/tools/test_bug_005_clusterer_initialization.py::test_experience_clusterer_accepts_clusterer_instance PASSED
tests/server/tools/test_bug_005_clusterer_initialization.py::test_value_store_accepts_experience_clusterer_instance PASSED
tests/server/tools/test_bug_005_clusterer_initialization.py::test_initialization_matches_fix_plan PASSED
tests/server/tools/test_bug_017_regression.py::test_bug_017_regression_get_clusters_no_collection PASSED
tests/server/tools/test_bug_019_regression.py::test_bug_019_regression_validate_value_none_similarity PASSED
tests/server/tools/test_bug_019_regression.py::test_bug_019_validate_value_with_similarity PASSED
tests/server/tools/test_bug_020_regression.py::test_bug_020_regression_store_value_valueerror PASSED
tests/server/tools/test_bug_020_regression.py::test_bug_020_store_value_success PASSED
tests/server/tools/test_bug_021_regression.py::test_bug_021_regression_search_experiences_serialization PASSED
tests/server/tools/test_bug_021_regression.py::test_bug_021_search_experiences_empty_results PASSED
tests/server/tools/test_bug_022_regression.py::test_delete_file_units_handles_more_than_1000_entries PASSED
tests/server/tools/test_bug_022_regression.py::test_delete_file_units_handles_empty_collection PASSED
tests/server/tools/test_bug_022_regression.py::test_delete_file_units_handles_exactly_1000_entries PASSED
tests/server/tools/test_bug_023_regression.py::test_nomic_dimension_queries_model PASSED
tests/server/tools/test_bug_023_regression.py::test_nomic_dimension_returns_actual_model_dimension PASSED
tests/server/tools/test_bug_023_regression.py::test_nomic_dimension_raises_on_none PASSED
tests/server/tools/test_bug_024_regression.py::test_inmemory_error_message_contains_not_found PASSED
tests/server/tools/test_bug_024_regression.py::test_inmemory_search_raises_collection_not_found PASSED
tests/server/tools/test_bug_024_regression.py::test_inmemory_upsert_raises_collection_not_found PASSED
tests/server/tools/test_bug_024_regression.py::test_inmemory_scroll_raises_collection_not_found PASSED
tests/server/tools/test_bug_024_regression.py::test_inmemory_count_raises_collection_not_found PASSED
tests/server/tools/test_bug_024_regression.py::test_inmemory_get_raises_collection_not_found PASSED
tests/server/tools/test_bug_024_regression.py::test_inmemory_delete_raises_collection_not_found PASSED
tests/server/tools/test_bug_025_regression.py::test_gte_filter PASSED
tests/server/tools/test_bug_025_regression.py::test_lte_filter PASSED
tests/server/tools/test_bug_025_regression.py::test_gt_filter PASSED
tests/server/tools/test_bug_025_regression.py::test_lt_filter PASSED
tests/server/tools/test_bug_025_regression.py::test_in_filter PASSED
tests/server/tools/test_bug_025_regression.py::test_combined_range_filters PASSED
tests/server/tools/test_bug_025_regression.py::test_range_filter_with_equality PASSED
tests/server/tools/test_bug_025_regression.py::test_simple_equality_still_works PASSED
tests/server/tools/test_bug_026_regression.py::TestDomainEnumConsistency::test_start_ghap_domain_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestDomainEnumConsistency::test_list_ghap_entries_domain_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestDomainEnumConsistency::test_search_experiences_domain_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestStrategyEnumConsistency::test_start_ghap_strategy_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestStrategyEnumConsistency::test_update_ghap_strategy_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestOutcomeEnumConsistency::test_resolve_ghap_status_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestOutcomeEnumConsistency::test_list_ghap_entries_outcome_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestOutcomeEnumConsistency::test_search_experiences_outcome_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestRootCauseEnumConsistency::test_resolve_ghap_root_cause_category_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestAxisEnumConsistency::test_get_clusters_axis_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestAxisEnumConsistency::test_store_value_axis_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestAxisEnumConsistency::test_list_values_axis_matches_enums PASSED
tests/server/tools/test_bug_026_regression.py::TestAxisEnumConsistency::test_search_experiences_axis_matches_enums PASSED
tests/server/tools/test_bug_027_regression.py::TestListGhapEntriesDatetimeParsing::test_fromisoformat_parses_iso_string PASSED
tests/server/tools/test_bug_027_regression.py::TestListGhapEntriesDatetimeParsing::test_fromisoformat_handles_various_formats PASSED
tests/server/tools/test_bug_027_regression.py::TestListGhapEntriesDatetimeParsing::test_fromtimestamp_fails_on_iso_string PASSED
tests/server/tools/test_bug_028_regression.py::TestContextItemHashEqContract::test_equal_items_have_equal_hash PASSED
tests/server/tools/test_bug_028_regression.py::TestContextItemHashEqContract::test_items_with_different_length_have_different_hash PASSED
tests/server/tools/test_bug_028_regression.py::TestContextItemHashEqContract::test_items_with_same_prefix_different_suffix_in_set PASSED
tests/server/tools/test_bug_028_regression.py::TestContextItemHashEqContract::test_identical_items_deduplicate_in_set PASSED
tests/server/tools/test_bug_028_regression.py::TestContextItemHashEqContract::test_items_with_different_source_not_equal PASSED
tests/server/tools/test_bug_028_regression.py::TestContextItemHashEqContract::test_dict_key_behavior PASSED
tests/server/tools/test_bug_028_regression.py::TestContextItemHashEqContract::test_short_content_hashes_correctly PASSED
tests/server/tools/test_bug_029_regression.py::TestBug029ActiveGhapError::test_start_ghap_with_active_returns_helpful_error PASSED
tests/server/tools/test_bug_029_regression.py::TestBug029ActiveGhapError::test_start_ghap_succeeds_after_resolve PASSED
tests/server/tools/test_bug_030_regression.py::test_start_ghap_returns_minimal_response PASSED
tests/server/tools/test_bug_030_regression.py::test_resolve_ghap_returns_minimal_response PASSED
tests/server/tools/test_bug_030_regression.py::test_update_ghap_response_unchanged PASSED
tests/server/tools/test_code.py::test_index_codebase_not_available PASSED
tests/server/tools/test_code.py::test_search_code_not_available PASSED
tests/server/tools/test_code.py::test_find_similar_code_not_available PASSED
tests/server/tools/test_code.py::test_search_code_empty_query PASSED
tests/server/tools/test_code.py::test_search_code_limit_validation PASSED
tests/server/tools/test_code.py::test_find_similar_code_snippet_too_long PASSED
tests/server/tools/test_code.py::test_find_similar_code_empty_snippet PASSED
tests/server/tools/test_code.py::test_find_similar_code_limit_validation PASSED
tests/server/tools/test_code.py::test_index_codebase_directory_not_found PASSED
tests/server/tools/test_code.py::test_index_codebase_not_a_directory PASSED
tests/server/tools/test_code.py::test_search_code_with_filters PASSED
tests/server/tools/test_code.py::test_find_similar_code_with_project_filter PASSED
tests/server/tools/test_enums.py::TestDomains::test_valid_domains PASSED
tests/server/tools/test_enums.py::TestDomains::test_invalid_domain_raises_error PASSED
tests/server/tools/test_enums.py::TestDomains::test_error_message_includes_valid_options PASSED
tests/server/tools/test_enums.py::TestStrategies::test_valid_strategies PASSED
tests/server/tools/test_enums.py::TestStrategies::test_invalid_strategy_raises_error PASSED
tests/server/tools/test_enums.py::TestStrategies::test_error_message_includes_valid_options PASSED
tests/server/tools/test_enums.py::TestAxes::test_valid_axes PASSED
tests/server/tools/test_enums.py::TestAxes::test_invalid_axis_raises_error PASSED
tests/server/tools/test_enums.py::TestAxes::test_error_message_includes_valid_options PASSED
tests/server/tools/test_enums.py::TestAxes::test_domain_is_not_a_valid_axis PASSED
tests/server/tools/test_enums.py::TestOutcomeStatus::test_valid_outcome_statuses PASSED
tests/server/tools/test_enums.py::TestOutcomeStatus::test_invalid_outcome_status_raises_error PASSED
tests/server/tools/test_enums.py::TestOutcomeStatus::test_error_message_includes_valid_options PASSED
tests/server/tools/test_enums.py::TestRootCauseCategories::test_valid_root_cause_categories PASSED
tests/server/tools/test_enums.py::TestRootCauseCategories::test_invalid_root_cause_category_raises_error PASSED
tests/server/tools/test_enums.py::TestRootCauseCategories::test_error_message_includes_valid_options PASSED
tests/server/tools/test_errors.py::test_mcp_error_is_exception PASSED
tests/server/tools/test_errors.py::test_validation_error_is_mcp_error PASSED
tests/server/tools/test_errors.py::test_not_found_error_is_mcp_error PASSED
tests/server/tools/test_errors.py::test_insufficient_data_error_is_mcp_error PASSED
tests/server/tools/test_errors.py::test_errors_can_be_raised PASSED
tests/server/tools/test_ghap.py::TestStartGhap::test_start_ghap_success PASSED
tests/server/tools/test_ghap.py::TestStartGhap::test_start_ghap_invalid_domain PASSED
tests/server/tools/test_ghap.py::TestStartGhap::test_start_ghap_invalid_strategy PASSED
tests/server/tools/test_ghap.py::TestStartGhap::test_start_ghap_empty_field PASSED
tests/server/tools/test_ghap.py::TestStartGhap::test_start_ghap_field_too_long PASSED
tests/server/tools/test_ghap.py::TestUpdateGhap::test_update_ghap_success PASSED
tests/server/tools/test_ghap.py::TestUpdateGhap::test_update_ghap_no_active_entry PASSED
tests/server/tools/test_ghap.py::TestUpdateGhap::test_update_ghap_field_too_long PASSED
tests/server/tools/test_ghap.py::TestResolveGhap::test_resolve_ghap_confirmed PASSED
tests/server/tools/test_ghap.py::TestResolveGhap::test_resolve_ghap_falsified PASSED
tests/server/tools/test_ghap.py::TestResolveGhap::test_resolve_ghap_falsified_missing_surprise PASSED
tests/server/tools/test_ghap.py::TestResolveGhap::test_resolve_ghap_invalid_status PASSED
tests/server/tools/test_ghap.py::TestGetActiveGhap::test_get_active_ghap_with_entry PASSED
tests/server/tools/test_ghap.py::TestGetActiveGhap::test_get_active_ghap_no_entry PASSED
tests/server/tools/test_ghap.py::TestListGhapEntries::test_list_ghap_entries_default PASSED
tests/server/tools/test_ghap.py::TestListGhapEntries::test_list_ghap_entries_invalid_limit PASSED
tests/server/tools/test_ghap.py::TestListGhapEntries::test_list_ghap_entries_invalid_domain PASSED
tests/server/tools/test_ghap.py::TestListGhapEntries::test_list_ghap_entries_invalid_date PASSED
tests/server/tools/test_ghap.py::test_bug_001_schema_validation_alignment PASSED
tests/server/tools/test_git.py::test_search_commits_not_available PASSED
tests/server/tools/test_git.py::test_get_file_history_not_available PASSED
tests/server/tools/test_git.py::test_get_churn_hotspots_not_available PASSED
tests/server/tools/test_git.py::test_get_code_authors_not_available PASSED
tests/server/tools/test_git.py::test_search_commits_empty_query PASSED
tests/server/tools/test_git.py::test_search_commits_limit_validation PASSED
tests/server/tools/test_git.py::test_search_commits_invalid_date_format PASSED
tests/server/tools/test_git.py::test_get_file_history_limit_validation PASSED
tests/server/tools/test_git.py::test_get_file_history_file_not_found PASSED
tests/server/tools/test_git.py::test_get_churn_hotspots_days_validation PASSED
tests/server/tools/test_git.py::test_get_churn_hotspots_limit_validation PASSED
tests/server/tools/test_git.py::test_get_code_authors_file_not_found PASSED
tests/server/tools/test_git.py::test_index_commits_not_available PASSED
tests/server/tools/test_git.py::test_index_commits_invalid_date_format PASSED
tests/server/tools/test_git.py::test_index_commits_invalid_limit PASSED
tests/server/tools/test_git.py::test_index_and_search_commits_workflow PASSED
tests/server/tools/test_git.py::test_index_commits_with_errors PASSED
tests/server/tools/test_git.py::test_search_commits_includes_scores PASSED
tests/server/tools/test_learning.py::TestGetClusters::test_get_clusters_success PASSED
tests/server/tools/test_learning.py::TestGetClusters::test_get_clusters_invalid_axis PASSED
tests/server/tools/test_learning.py::TestGetClusters::test_get_clusters_insufficient_data PASSED
tests/server/tools/test_learning.py::TestGetClusterMembers::test_get_cluster_members_success PASSED
tests/server/tools/test_learning.py::TestGetClusterMembers::test_get_cluster_members_invalid_format PASSED
tests/server/tools/test_learning.py::TestGetClusterMembers::test_get_cluster_members_invalid_axis PASSED
tests/server/tools/test_learning.py::TestGetClusterMembers::test_get_cluster_members_invalid_limit PASSED
tests/server/tools/test_learning.py::TestValidateValue::test_validate_value_success PASSED
tests/server/tools/test_learning.py::TestValidateValue::test_validate_value_empty_text PASSED
tests/server/tools/test_learning.py::TestValidateValue::test_validate_value_text_too_long PASSED
tests/server/tools/test_learning.py::TestValidateValue::test_validate_value_invalid_cluster_id PASSED
tests/server/tools/test_learning.py::TestStoreValue::test_store_value_success PASSED
tests/server/tools/test_learning.py::TestStoreValue::test_store_value_empty_text PASSED
tests/server/tools/test_learning.py::TestStoreValue::test_store_value_invalid_axis PASSED
tests/server/tools/test_learning.py::TestListValues::test_list_values_default PASSED
tests/server/tools/test_learning.py::TestListValues::test_list_values_with_axis_filter PASSED
tests/server/tools/test_learning.py::TestListValues::test_list_values_invalid_axis PASSED
tests/server/tools/test_learning.py::TestListValues::test_list_values_invalid_limit PASSED
tests/server/tools/test_memory.py::test_store_memory_success PASSED
tests/server/tools/test_memory.py::test_store_memory_invalid_category PASSED
tests/server/tools/test_memory.py::test_store_memory_content_too_long PASSED
tests/server/tools/test_memory.py::test_store_memory_importance_out_of_range PASSED
tests/server/tools/test_memory.py::test_store_memory_default_values PASSED
tests/server/tools/test_memory.py::test_retrieve_memories_success PASSED
tests/server/tools/test_memory.py::test_retrieve_memories_empty_query PASSED
tests/server/tools/test_memory.py::test_retrieve_memories_with_filters PASSED
tests/server/tools/test_memory.py::test_retrieve_memories_invalid_category PASSED
tests/server/tools/test_memory.py::test_retrieve_memories_limit_validation PASSED
tests/server/tools/test_memory.py::test_list_memories_success PASSED
tests/server/tools/test_memory.py::test_list_memories_pagination PASSED
tests/server/tools/test_memory.py::test_list_memories_with_filters PASSED
tests/server/tools/test_memory.py::test_list_memories_invalid_offset PASSED
tests/server/tools/test_memory.py::test_list_memories_limit_validation PASSED
tests/server/tools/test_memory.py::test_delete_memory_success PASSED
tests/server/tools/test_memory.py::test_delete_memory_not_found PASSED
tests/server/tools/test_memory.py::test_all_valid_categories_accepted PASSED
tests/server/tools/test_search.py::TestSearchExperiences::test_search_experiences_success PASSED
tests/server/tools/test_search.py::TestSearchExperiences::test_search_experiences_empty_query PASSED
tests/server/tools/test_search.py::TestSearchExperiences::test_search_experiences_with_filters PASSED
tests/server/tools/test_search.py::TestSearchExperiences::test_search_experiences_invalid_axis PASSED
tests/server/tools/test_search.py::TestSearchExperiences::test_search_experiences_invalid_domain PASSED
tests/server/tools/test_search.py::TestSearchExperiences::test_search_experiences_invalid_outcome PASSED
tests/server/tools/test_search.py::TestSearchExperiences::test_search_experiences_invalid_limit PASSED
tests/server/tools/test_search.py::TestSearchExperiences::test_search_experiences_limit_max PASSED
tests/storage/test_bug_034_regression.py::TestBug034FloatTimeoutRegression::test_subsecond_timeout_not_truncated_to_zero PASSED
tests/storage/test_bug_034_regression.py::TestBug034FloatTimeoutRegression::test_float_timeout_preserves_decimal PASSED
tests/storage/test_bug_034_regression.py::TestBug034FloatTimeoutRegression::test_integer_timeout_still_works PASSED
tests/storage/test_bug_034_regression.py::TestBug034FloatTimeoutRegression::test_url_mode_timeout_not_truncated PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_create_collection PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_create_duplicate_collection PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_delete_collection PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_upsert_and_get PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_upsert_update PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_upsert_wrong_dimension PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_search_cosine_similarity PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_search_with_filters PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_delete PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_scroll PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_scroll_with_filters PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_count PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_count_with_filters PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_get_nonexistent PASSED
tests/storage/test_memory.py::TestInMemoryVectorStore::test_operations_on_nonexistent_collection PASSED
tests/storage/test_metadata.py::TestIndexedFiles::test_add_indexed_file PASSED
tests/storage/test_metadata.py::TestIndexedFiles::test_add_indexed_file_upsert PASSED
tests/storage/test_metadata.py::TestIndexedFiles::test_get_indexed_file PASSED
tests/storage/test_metadata.py::TestIndexedFiles::test_get_indexed_file_not_found PASSED
tests/storage/test_metadata.py::TestIndexedFiles::test_list_indexed_files PASSED
tests/storage/test_metadata.py::TestIndexedFiles::test_list_indexed_files_all_projects PASSED
tests/storage/test_metadata.py::TestIndexedFiles::test_get_stale_files PASSED
tests/storage/test_metadata.py::TestIndexedFiles::test_delete_indexed_file PASSED
tests/storage/test_metadata.py::TestCallGraph::test_add_call PASSED
tests/storage/test_metadata.py::TestCallGraph::test_add_call_upsert PASSED
tests/storage/test_metadata.py::TestCallGraph::test_get_callers PASSED
tests/storage/test_metadata.py::TestCallGraph::test_get_callees PASSED
tests/storage/test_metadata.py::TestCallGraph::test_delete_calls_for_file PASSED
tests/storage/test_metadata.py::TestProjects::test_add_project PASSED
tests/storage/test_metadata.py::TestProjects::test_add_project_default_settings PASSED
tests/storage/test_metadata.py::TestProjects::test_add_project_upsert PASSED
tests/storage/test_metadata.py::TestProjects::test_get_project PASSED
tests/storage/test_metadata.py::TestProjects::test_get_project_not_found PASSED
tests/storage/test_metadata.py::TestProjects::test_list_projects PASSED
tests/storage/test_metadata.py::TestProjects::test_update_project_last_indexed PASSED
tests/storage/test_metadata.py::TestProjects::test_delete_project PASSED
tests/storage/test_metadata.py::TestJSONSerialization::test_complex_settings_roundtrip PASSED
tests/storage/test_metadata.py::TestJSONSerialization::test_empty_settings_roundtrip PASSED
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_simple_equality_filter PASSED
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_multiple_equality_filters PASSED
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_in_operator_filter PASSED
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_gte_operator_filter PASSED
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_lte_operator_filter PASSED
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_gte_and_lte_combined PASSED
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_mixed_operators_in_single_query PASSED
tests/test_json_merge.py::test_merge_mcp_server_new PASSED
tests/test_json_merge.py::test_merge_mcp_server_existing PASSED
tests/test_json_merge.py::test_merge_mcp_server_no_change PASSED
tests/test_json_merge.py::test_merge_hooks_preserves_existing PASSED
tests/test_json_merge.py::test_merge_hooks_new_event PASSED
tests/test_json_merge.py::test_merge_hooks_updates_existing PASSED
tests/test_json_merge.py::test_merge_hooks_no_change PASSED
tests/test_json_merge.py::test_remove_mcp_server PASSED
tests/test_json_merge.py::test_remove_mcp_server_not_found PASSED
tests/test_json_merge.py::test_remove_hooks PASSED
tests/test_json_merge.py::test_remove_hooks_multiple_commands PASSED
tests/test_json_merge.py::test_remove_hooks_not_found PASSED
tests/test_placeholder.py::test_placeholder PASSED
tests/test_placeholder.py::test_fixture PASSED
tests/values/test_integration.py::TestIntegration::test_full_workflow PASSED
tests/values/test_integration.py::TestIntegration::test_invalid_value_rejected PASSED
tests/values/test_integration.py::TestIntegration::test_multiple_values_per_cluster PASSED
tests/values/test_integration.py::TestIntegration::test_real_embedding_consistency PASSED
tests/values/test_store.py::TestGetClusters::test_valid_axis PASSED
tests/values/test_store.py::TestGetClusters::test_sorted_by_size_descending PASSED
tests/values/test_store.py::TestGetClusters::test_invalid_axis PASSED
tests/values/test_store.py::TestGetClusters::test_domain_not_valid_axis PASSED
tests/values/test_store.py::TestGetClusters::test_all_valid_axes[full] PASSED
tests/values/test_store.py::TestGetClusters::test_all_valid_axes[strategy] PASSED
tests/values/test_store.py::TestGetClusters::test_all_valid_axes[surprise] PASSED
tests/values/test_store.py::TestGetClusters::test_all_valid_axes[root_cause] PASSED
tests/values/test_store.py::TestGetClusters::test_insufficient_experiences PASSED
tests/values/test_store.py::TestGetClusterMembers::test_get_members_success PASSED
tests/values/test_store.py::TestGetClusterMembers::test_invalid_cluster_id_format PASSED
tests/values/test_store.py::TestGetClusterMembers::test_invalid_axis_in_cluster_id PASSED
tests/values/test_store.py::TestGetClusterMembers::test_cluster_not_found PASSED
tests/values/test_store.py::TestGetClusterMembers::test_correct_collection_name PASSED
tests/values/test_store.py::TestValidateValueCandidate::test_valid_candidate_close_to_centroid PASSED
tests/values/test_store.py::TestValidateValueCandidate::test_invalid_candidate_far_from_centroid PASSED
tests/values/test_store.py::TestValidateValueCandidate::test_empty_cluster PASSED
tests/values/test_store.py::TestValidateValueCandidate::test_validation_threshold_calculation PASSED
tests/values/test_store.py::TestValidateValueCandidate::test_validate_with_insufficient_experiences PASSED
tests/values/test_store.py::TestStoreValue::test_store_valid_value PASSED
tests/values/test_store.py::TestStoreValue::test_store_invalid_value_raises_error PASSED
tests/values/test_store.py::TestStoreValue::test_value_id_format PASSED
tests/values/test_store.py::TestStoreValue::test_stored_payload_structure PASSED
tests/values/test_store.py::TestListValues::test_list_all_values PASSED
tests/values/test_store.py::TestListValues::test_list_values_filtered_by_axis PASSED
tests/values/test_store.py::TestListValues::test_list_values_invalid_axis PASSED
tests/values/test_store.py::TestListValues::test_list_values_sorted_by_recency PASSED
tests/values/test_store.py::TestGetCluster::test_get_cluster_success PASSED
tests/values/test_store.py::TestGetCluster::test_get_cluster_invalid_format PASSED
tests/values/test_store.py::TestGetCluster::test_get_cluster_not_found PASSED
tests/values/test_store.py::TestInsufficientDataRegression::test_get_clusters_with_insufficient_data PASSED
tests/values/test_store.py::TestInsufficientDataRegression::test_validate_value_with_insufficient_data PASSED
tests/values/test_store.py::TestInsufficientDataRegression::test_store_value_with_insufficient_data PASSED

=============================== warnings summary ===============================
tests/clustering/test_bug_031_regression.py: 6 warnings
tests/clustering/test_clusterer.py: 208 warnings
tests/clustering/test_experience.py: 22 warnings
  /Users/elliotmilco/Documents/GitHub/clams/.worktrees/BUG-065/.venv/lib/python3.12/site-packages/sklearn/utils/deprecation.py:132: FutureWarning: 'force_all_finite' was renamed to 'ensure_all_finite' in 1.6 and will be removed in 1.8.
    warnings.warn(

tests/server/test_main.py::test_create_server
tests/server/test_main.py::test_server_has_ping_tool
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_simple_equality_filter
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_multiple_equality_filters
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_in_operator_filter
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_gte_operator_filter
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_lte_operator_filter
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_gte_and_lte_combined
tests/storage/test_qdrant_filters.py::TestQdrantFilterBuilding::test_mixed_operators_in_single_query
  /Users/elliotmilco/Documents/GitHub/clams/.worktrees/BUG-065/src/clams/storage/qdrant.py:62: UserWarning: Qdrant client version 1.16.1 is incompatible with server version 1.12.1. Major versions should match and minor version difference must not exceed 1. Set check_compatibility=False to skip version check.
    self._client = AsyncQdrantClient(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
========= 695 passed, 56 deselected, 245 warnings in 159.62s (0:02:39) =========

=== Test Summary ===
Total: 695 | Passed: 695 | Failed: 0 | Errors: 0 | Skipped: 0
Duration: 159.62s
Test results logged to database

PASS: All tests passed
✓ Tests pass: PASS

--- Gate: Linter clean ---
=== Running Linter ===
Directory: /Users/elliotmilco/Documents/GitHub/clams/.worktrees/BUG-065

Detected: Python
Running: ruff check
I001 [*] Import block is un-sorted or un-formatted
  --> generate_12_ghap_async_debug.py:3:1
   |
 1 |   """Generate 12 GHAP entries for async/concurrent debugging theme."""
 2 |
 3 | / import asyncio
 4 | | from datetime import datetime
 5 | |
 6 | | from clams.observation import (
 7 | |     Domain,
 8 | |     Lesson,
 9 | |     ObservationCollector,
10 | |     ObservationPersister,
11 | |     OutcomeStatus,
12 | |     RootCause,
13 | |     Strategy,
14 | | )
15 | | from clams.storage.qdrant import QdrantVectorStore
16 | | from clams.embedding import NomicEmbedding
   | |__________________________________________^
   |
help: Organize imports

F401 [*] `datetime.datetime` imported but unused
 --> generate_12_ghap_async_debug.py:4:22
  |
3 | import asyncio
4 | from datetime import datetime
  |                      ^^^^^^^^
5 |
6 | from clams.observation import (
  |
help: Remove unused import: `datetime.datetime`

E501 Line too long (97 > 88)
  --> generate_12_ghap_async_debug.py:23:89
   |
21 |     {
22 |         "goal": "Fix race condition in user session handler causing data corruption",
23 |         "hypothesis": "Multiple requests updating session simultaneously without proper locking",
   |                                                                                         ^^^^^^^^^
24 |         "action": "Add mutex around session write operations",
25 |         "prediction": "Session corruption will stop after adding lock",
   |

E501 Line too long (110 > 88)
  --> generate_12_ghap_async_debug.py:28:89
   |
26 |         "strategy": Strategy.ROOT_CAUSE_ANALYSIS,
27 |         "outcome": "confirmed",
28 |         "result": "Added asyncio.Lock around session writes, corruption stopped completely in stress testing",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^
29 |         "lesson": {
30 |             "what_worked": "Identified race condition through concurrent request simulation, lock eliminated all corruption",
   |

E501 Line too long (125 > 88)
  --> generate_12_ghap_async_debug.py:30:89
   |
28 |         "result": "Added asyncio.Lock around session writes, corruption stopped completely in stress testing",
29 |         "lesson": {
30 |             "what_worked": "Identified race condition through concurrent request simulation, lock eliminated all corruption",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
31 |             "takeaway": "Always protect shared mutable state in async handlers with explicit locking primitives"
32 |         }
   |

E501 Line too long (112 > 88)
  --> generate_12_ghap_async_debug.py:31:89
   |
29 |         "lesson": {
30 |             "what_worked": "Identified race condition through concurrent request simulation, lock eliminated all corruption",
31 |             "takeaway": "Always protect shared mutable state in async handlers with explicit locking primitives"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^
32 |         }
33 |     },
   |

E501 Line too long (97 > 88)
  --> generate_12_ghap_async_debug.py:41:89
   |
39 |         "strategy": Strategy.SYSTEMATIC_ELIMINATION,
40 |         "outcome": "confirmed",
41 |         "result": "Implemented lock ordering by connection ID, no deadlocks in 48hr stress test",
   |                                                                                         ^^^^^^^^^
42 |         "lesson": {
43 |             "what_worked": "Thread dump analysis revealed lock inversion, consistent ordering resolved it",
   |

E501 Line too long (107 > 88)
  --> generate_12_ghap_async_debug.py:43:89
   |
41 |         "result": "Implemented lock ordering by connection ID, no deadlocks in 48hr stress test",
42 |         "lesson": {
43 |             "what_worked": "Thread dump analysis revealed lock inversion, consistent ordering resolved it",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^
44 |             "takeaway": "Lock ordering protocol prevents deadlocks in multi-resource scenarios"
45 |         }
   |

E501 Line too long (95 > 88)
  --> generate_12_ghap_async_debug.py:44:89
   |
42 |         "lesson": {
43 |             "what_worked": "Thread dump analysis revealed lock inversion, consistent ordering resolved it",
44 |             "takeaway": "Lock ordering protocol prevents deadlocks in multi-resource scenarios"
   |                                                                                         ^^^^^^^
45 |         }
46 |     },
   |

E501 Line too long (90 > 88)
  --> generate_12_ghap_async_debug.py:51:89
   |
49 |         "hypothesis": "Event loop blocking during I/O operations",
50 |         "action": "Offload CPU-intensive work to thread pool executor",
51 |         "prediction": "Timeouts will disappear after moving blocking work off event loop",
   |                                                                                         ^^
52 |         "strategy": Strategy.CHECK_ASSUMPTIONS,
53 |         "outcome": "falsified",
   |

E501 Line too long (122 > 88)
  --> generate_12_ghap_async_debug.py:58:89
   |
56 |         "root_cause": {
57 |             "category": "wrong_hypothesis",
58 |             "description": "Actual cause was connection pool exhaustion from not releasing connections in exception paths"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
59 |         },
60 |         "lesson": {
   |

E501 Line too long (103 > 88)
  --> generate_12_ghap_async_debug.py:62:89
   |
60 |         "lesson": {
61 |             "what_worked": "Added connection tracking revealed leak in error handlers",
62 |             "takeaway": "Profile before optimizing - assumed CPU bottleneck was actually resource leak"
   |                                                                                         ^^^^^^^^^^^^^^^
63 |         }
64 |     },
   |

E501 Line too long (96 > 88)
  --> generate_12_ghap_async_debug.py:72:89
   |
70 |         "strategy": Strategy.READ_THE_ERROR,
71 |         "outcome": "confirmed",
72 |         "result": "Added context managers for all connection usage, pool exhaustion eliminated",
   |                                                                                         ^^^^^^^^
73 |         "lesson": {
74 |             "what_worked": "Pool monitoring showed connections never freed, context managers fixed it",
   |

E501 Line too long (103 > 88)
  --> generate_12_ghap_async_debug.py:74:89
   |
72 |         "result": "Added context managers for all connection usage, pool exhaustion eliminated",
73 |         "lesson": {
74 |             "what_worked": "Pool monitoring showed connections never freed, context managers fixed it",
   |                                                                                         ^^^^^^^^^^^^^^^
75 |             "takeaway": "Always use context managers for resource cleanup in async code"
76 |         }
   |

E501 Line too long (117 > 88)
  --> generate_12_ghap_async_debug.py:89:89
   |
87 |         "root_cause": {
88 |             "category": "misunderstanding",
89 |             "description": "Used queue.get() instead of queue.get_nowait() inside a cancelled task, blocking forever"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
90 |         },
91 |         "lesson": {
   |

E501 Line too long (100 > 88)
  --> generate_12_ghap_async_debug.py:92:89
   |
90 |         },
91 |         "lesson": {
92 |             "what_worked": "Task cancellation testing revealed blocking get() in cancelled context",
   |                                                                                         ^^^^^^^^^^^^
93 |             "takeaway": "Use get_nowait() or get(timeout=) in cancellable async contexts"
94 |         }
   |

E501 Line too long (89 > 88)
  --> generate_12_ghap_async_debug.py:93:89
   |
91 |         "lesson": {
92 |             "what_worked": "Task cancellation testing revealed blocking get() in cancelled context",
93 |             "takeaway": "Use get_nowait() or get(timeout=) in cancellable async contexts"
   |                                                                                         ^
94 |         }
95 |     },
   |

E501 Line too long (95 > 88)
   --> generate_12_ghap_async_debug.py:103:89
    |
101 |         "strategy": Strategy.CHECK_ASSUMPTIONS,
102 |         "outcome": "confirmed",
103 |         "result": "Added try/except CancelledError with cleanup, no more unhandled exceptions",
    |                                                                                         ^^^^^^^
104 |         "lesson": {
105 |             "what_worked": "Wrapped task bodies with cancellation cleanup, errors disappeared",
    |

E501 Line too long (95 > 88)
   --> generate_12_ghap_async_debug.py:105:89
    |
103 |         "result": "Added try/except CancelledError with cleanup, no more unhandled exceptions",
104 |         "lesson": {
105 |             "what_worked": "Wrapped task bodies with cancellation cleanup, errors disappeared",
    |                                                                                         ^^^^^^^
106 |             "takeaway": "Always handle CancelledError explicitly in long-running async tasks"
107 |         }
    |

E501 Line too long (93 > 88)
   --> generate_12_ghap_async_debug.py:106:89
    |
104 |         "lesson": {
105 |             "what_worked": "Wrapped task bodies with cancellation cleanup, errors disappeared",
106 |             "takeaway": "Always handle CancelledError explicitly in long-running async tasks"
    |                                                                                         ^^^^^
107 |         }
108 |     },
    |

E501 Line too long (110 > 88)
   --> generate_12_ghap_async_debug.py:120:89
    |
118 |         "root_cause": {
119 |             "category": "wrong_hypothesis",
120 |             "description": "Actual cause was DNS resolution blocking - used sync getaddrinfo instead of async"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^
121 |         },
122 |         "lesson": {
    |

E501 Line too long (102 > 88)
   --> generate_12_ghap_async_debug.py:123:89
    |
121 |         },
122 |         "lesson": {
123 |             "what_worked": "Event loop instrumentation showed DNS calls blocking, switched to aiodns",
    |                                                                                         ^^^^^^^^^^^^^^
124 |             "takeaway": "DNS resolution is blocking by default in Python - use async DNS library"
125 |         }
    |

E501 Line too long (97 > 88)
   --> generate_12_ghap_async_debug.py:124:89
    |
122 |         "lesson": {
123 |             "what_worked": "Event loop instrumentation showed DNS calls blocking, switched to aiodns",
124 |             "takeaway": "DNS resolution is blocking by default in Python - use async DNS library"
    |                                                                                         ^^^^^^^^^
125 |         }
126 |     },
    |

E501 Line too long (89 > 88)
   --> generate_12_ghap_async_debug.py:130:89
    |
128 |         "goal": "Debug task leak causing unbounded memory growth",
129 |         "hypothesis": "Tasks being created but never awaited",
130 |         "action": "Enable asyncio debug mode and check for unawaited coroutine warnings",
    |                                                                                         ^
131 |         "prediction": "Debug mode will show which tasks are not being awaited",
132 |         "strategy": Strategy.READ_THE_ERROR,
    |

E501 Line too long (90 > 88)
   --> generate_12_ghap_async_debug.py:134:89
    |
132 |         "strategy": Strategy.READ_THE_ERROR,
133 |         "outcome": "confirmed",
134 |         "result": "Found 15 fire-and-forget tasks never awaited, collected them properly",
    |                                                                                         ^^
135 |         "lesson": {
136 |             "what_worked": "asyncio.run(debug=True) revealed all unawaited coroutines",
    |

E501 Line too long (112 > 88)
   --> generate_12_ghap_async_debug.py:151:89
    |
149 |         "root_cause": {
150 |             "category": "wrong_hypothesis",
151 |             "description": "Problem was actually semaphore release waking all waiters at once, not retry timing"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^
152 |         },
153 |         "lesson": {
    |

E501 Line too long (91 > 88)
   --> generate_12_ghap_async_debug.py:154:89
    |
152 |         },
153 |         "lesson": {
154 |             "what_worked": "Switched to queue-based fair acquisition instead of semaphore",
    |                                                                                         ^^^
155 |             "takeaway": "Semaphores can cause thundering herd - use queues for fair resource distribution"
156 |         }
    |

E501 Line too long (106 > 88)
   --> generate_12_ghap_async_debug.py:155:89
    |
153 |         "lesson": {
154 |             "what_worked": "Switched to queue-based fair acquisition instead of semaphore",
155 |             "takeaway": "Semaphores can cause thundering herd - use queues for fair resource distribution"
    |                                                                                         ^^^^^^^^^^^^^^^^^^
156 |         }
157 |     },
    |

E501 Line too long (106 > 88)
   --> generate_12_ghap_async_debug.py:167:89
    |
165 |         "result": "Released lock before nested call, deadlock eliminated",
166 |         "lesson": {
167 |             "what_worked": "Lock ordering analysis showed circular dependency, early release broke cycle",
    |                                                                                         ^^^^^^^^^^^^^^^^^^
168 |             "takeaway": "Never hold lock while calling code that might acquire the same lock"
169 |         }
    |

E501 Line too long (93 > 88)
   --> generate_12_ghap_async_debug.py:168:89
    |
166 |         "lesson": {
167 |             "what_worked": "Lock ordering analysis showed circular dependency, early release broke cycle",
168 |             "takeaway": "Never hold lock while calling code that might acquire the same lock"
    |                                                                                         ^^^^^
169 |         }
170 |     },
    |

E501 Line too long (97 > 88)
   --> generate_12_ghap_async_debug.py:181:89
    |
179 |         "lesson": {
180 |             "what_worked": "Lock around check+set makes it atomic, prevents race",
181 |             "takeaway": "Check-then-act patterns need atomicity - use locks or atomic primitives"
    |                                                                                         ^^^^^^^^^
182 |         }
183 |     },
    |

E501 Line too long (90 > 88)
   --> generate_12_ghap_async_debug.py:192:89
    |
190 |         "outcome": "falsified",
191 |         "result": "Inner calls already timeout correctly with wait_for",
192 |         "surprise": "wait_for cancels entire task tree, timeout propagates automatically",
    |                                                                                         ^^
193 |         "root_cause": {
194 |             "category": "misunderstanding",
    |

E501 Line too long (117 > 88)
   --> generate_12_ghap_async_debug.py:195:89
    |
193 |         "root_cause": {
194 |             "category": "misunderstanding",
195 |             "description": "Thought timeout needed manual propagation, but wait_for cancels the whole coroutine tree"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
196 |         },
197 |         "lesson": {
    |

E501 Line too long (93 > 88)
   --> generate_12_ghap_async_debug.py:198:89
    |
196 |         },
197 |         "lesson": {
198 |             "what_worked": "wait_for handles nested timeouts automatically via cancellation",
    |                                                                                         ^^^^^
199 |             "takeaway": "asyncio.wait_for propagates timeout through entire coroutine chain"
200 |         }
    |

E501 Line too long (92 > 88)
   --> generate_12_ghap_async_debug.py:199:89
    |
197 |         "lesson": {
198 |             "what_worked": "wait_for handles nested timeouts automatically via cancellation",
199 |             "takeaway": "asyncio.wait_for propagates timeout through entire coroutine chain"
    |                                                                                         ^^^^
200 |         }
201 |     }
    |

E501 Line too long (92 > 88)
   --> generate_12_ghap_async_debug.py:212:89
    |
211 |     collector = ObservationCollector()
212 |     persister = ObservationPersister(vector_store=vector_store, embedding_service=embedding)
    |                                                                                         ^^^^
213 |
214 |     print(f"Generating {len(GHAP_ENTRIES)} GHAP entries for async/concurrent debugging...")
    |

E501 Line too long (91 > 88)
   --> generate_12_ghap_async_debug.py:214:89
    |
212 |     persister = ObservationPersister(vector_store=vector_store, embedding_service=embedding)
213 |
214 |     print(f"Generating {len(GHAP_ENTRIES)} GHAP entries for async/concurrent debugging...")
    |                                                                                         ^^^
215 |
216 |     for i, entry_data in enumerate(GHAP_ENTRIES, 1):
    |

E501 Line too long (101 > 88)
   --> generate_12_ghap_async_debug.py:228:89
    |
226 |             )
227 |
228 |             print(f"[{i}/{len(GHAP_ENTRIES)}] Created GHAP {entry.id}: {entry_data['goal'][:60]}...")
    |                                                                                         ^^^^^^^^^^^^^
229 |
230 |             # Prepare outcome data
    |

E501 Line too long (106 > 88)
   --> generate_12_ghap_async_debug.py:275:89
    |
274 |     print(f"\nSuccessfully generated {len(GHAP_ENTRIES)} GHAP entries!")
275 |     print("All entries focused on: async/concurrent debugging, race conditions, deadlocks, timing issues")
    |                                                                                         ^^^^^^^^^^^^^^^^^^
    |

I001 [*] Import block is un-sorted or un-formatted
  --> generate_api_network_ghap.py:3:1
   |
 1 |   """Generate 12 GHAP entries for debugging API and network issues."""
 2 |
 3 | / import asyncio
 4 | | import random
 5 | | from datetime import datetime
 6 | |
 7 | | from clams.observation import (
 8 | |     Domain,
 9 | |     Lesson,
10 | |     ObservationCollector,
11 | |     ObservationPersister,
12 | |     OutcomeStatus,
13 | |     RootCause,
14 | |     Strategy,
15 | | )
16 | | from clams.storage.qdrant import QdrantVectorStore
17 | | from clams.embedding import NomicEmbedding
   | |__________________________________________^
   |
help: Organize imports

F401 [*] `random` imported but unused
 --> generate_api_network_ghap.py:4:8
  |
3 | import asyncio
4 | import random
  |        ^^^^^^
5 | from datetime import datetime
  |
help: Remove unused import: `random`

F401 [*] `datetime.datetime` imported but unused
 --> generate_api_network_ghap.py:5:22
  |
3 | import asyncio
4 | import random
5 | from datetime import datetime
  |                      ^^^^^^^^
6 |
7 | from clams.observation import (
  |
help: Remove unused import: `datetime.datetime`

E501 Line too long (103 > 88)
  --> generate_api_network_ghap.py:23:89
   |
21 | GHAP_ENTRIES = [
22 |     {
23 |         "goal": "Fix API timeout errors occurring after exactly 30 seconds on /v1/embeddings endpoint",
   |                                                                                         ^^^^^^^^^^^^^^^
24 |         "hypothesis": "Default HTTP client timeout is too short for large embedding batches",
25 |         "action": "Increase httpx client timeout from 30s to 120s for embedding requests",
   |

E501 Line too long (93 > 88)
  --> generate_api_network_ghap.py:24:89
   |
22 |     {
23 |         "goal": "Fix API timeout errors occurring after exactly 30 seconds on /v1/embeddings endpoint",
24 |         "hypothesis": "Default HTTP client timeout is too short for large embedding batches",
   |                                                                                         ^^^^^
25 |         "action": "Increase httpx client timeout from 30s to 120s for embedding requests",
26 |         "prediction": "Large batches will complete successfully with longer timeout",
   |

E501 Line too long (90 > 88)
  --> generate_api_network_ghap.py:25:89
   |
23 |         "goal": "Fix API timeout errors occurring after exactly 30 seconds on /v1/embeddings endpoint",
24 |         "hypothesis": "Default HTTP client timeout is too short for large embedding batches",
25 |         "action": "Increase httpx client timeout from 30s to 120s for embedding requests",
   |                                                                                         ^^
26 |         "prediction": "Large batches will complete successfully with longer timeout",
27 |         "strategy": Strategy.ROOT_CAUSE_ANALYSIS,
   |

E501 Line too long (120 > 88)
  --> generate_api_network_ghap.py:29:89
   |
27 |         "strategy": Strategy.ROOT_CAUSE_ANALYSIS,
28 |         "outcome": "confirmed",
29 |         "result": "Extended timeout to 120s, all large batch requests now complete successfully without timeout errors",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
30 |         "lesson": {
31 |             "what_worked": "Identified exact 30s timeout pattern, traced to httpx default timeout, increased limit resolved issue",
   |

E501 Line too long (131 > 88)
  --> generate_api_network_ghap.py:31:89
   |
29 |         "result": "Extended timeout to 120s, all large batch requests now complete successfully without timeout errors",
30 |         "lesson": {
31 |             "what_worked": "Identified exact 30s timeout pattern, traced to httpx default timeout, increased limit resolved issue",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
32 |             "takeaway": "Set explicit timeouts based on expected operation duration, not client defaults"
33 |         }
   |

E501 Line too long (105 > 88)
  --> generate_api_network_ghap.py:32:89
   |
30 |         "lesson": {
31 |             "what_worked": "Identified exact 30s timeout pattern, traced to httpx default timeout, increased limit resolved issue",
32 |             "takeaway": "Set explicit timeouts based on expected operation duration, not client defaults"
   |                                                                                         ^^^^^^^^^^^^^^^^^
33 |         }
34 |     },
   |

E501 Line too long (118 > 88)
  --> generate_api_network_ghap.py:42:89
   |
40 |         "strategy": Strategy.SYSTEMATIC_ELIMINATION,
41 |         "outcome": "confirmed",
42 |         "result": "Implemented tenacity retry decorator with exponential backoff, 503 errors recovered automatically",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
43 |         "lesson": {
44 |             "what_worked": "Retry logic with backoff handles transient service failures gracefully",
   |

E501 Line too long (100 > 88)
  --> generate_api_network_ghap.py:44:89
   |
42 |         "result": "Implemented tenacity retry decorator with exponential backoff, 503 errors recovered automatically",
43 |         "lesson": {
44 |             "what_worked": "Retry logic with backoff handles transient service failures gracefully",
   |                                                                                         ^^^^^^^^^^^^
45 |             "takeaway": "Always implement retry logic for external API calls with exponential backoff"
46 |         }
   |

E501 Line too long (102 > 88)
  --> generate_api_network_ghap.py:45:89
   |
43 |         "lesson": {
44 |             "what_worked": "Retry logic with backoff handles transient service failures gracefully",
45 |             "takeaway": "Always implement retry logic for external API calls with exponential backoff"
   |                                                                                         ^^^^^^^^^^^^^^
46 |         }
47 |     },
   |

E501 Line too long (134 > 88)
  --> generate_api_network_ghap.py:59:89
   |
57 |         "root_cause": {
58 |             "category": "wrong_hypothesis",
59 |             "description": "API has separate per-endpoint limits not documented - /search has 20 req/min while /embed has 100 req/min"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
60 |         },
61 |         "lesson": {
   |

E501 Line too long (109 > 88)
  --> generate_api_network_ghap.py:62:89
   |
60 |         },
61 |         "lesson": {
62 |             "what_worked": "Added per-endpoint rate limiting based on response headers, eliminated all 429s",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^
63 |             "takeaway": "Don't trust documented rate limits - read actual limit headers from responses"
64 |         }
   |

E501 Line too long (103 > 88)
  --> generate_api_network_ghap.py:63:89
   |
61 |         "lesson": {
62 |             "what_worked": "Added per-endpoint rate limiting based on response headers, eliminated all 429s",
63 |             "takeaway": "Don't trust documented rate limits - read actual limit headers from responses"
   |                                                                                         ^^^^^^^^^^^^^^^
64 |         }
65 |     },
   |

E501 Line too long (89 > 88)
  --> generate_api_network_ghap.py:73:89
   |
71 |         "strategy": Strategy.DIVIDE_AND_CONQUER,
72 |         "outcome": "falsified",
73 |         "result": "Larger pool delayed the problem but errors still occurred under load",
   |                                                                                         ^
74 |         "surprise": "File descriptor exhaustion persisted even with larger pool",
75 |         "root_cause": {
   |

E501 Line too long (126 > 88)
  --> generate_api_network_ghap.py:77:89
   |
75 |         "root_cause": {
76 |             "category": "wrong_hypothesis",
77 |             "description": "Connections were leaking due to missing connection cleanup in error paths - not a pool size issue"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
78 |         },
79 |         "lesson": {
   |

E501 Line too long (104 > 88)
  --> generate_api_network_ghap.py:80:89
   |
78 |         },
79 |         "lesson": {
80 |             "what_worked": "Added explicit connection close in finally blocks, leak stopped completely",
   |                                                                                         ^^^^^^^^^^^^^^^^
81 |             "takeaway": "Connection leaks look like pool exhaustion - check cleanup in error paths first"
82 |         }
   |

E501 Line too long (105 > 88)
  --> generate_api_network_ghap.py:81:89
   |
79 |         "lesson": {
80 |             "what_worked": "Added explicit connection close in finally blocks, leak stopped completely",
81 |             "takeaway": "Connection leaks look like pool exhaustion - check cleanup in error paths first"
   |                                                                                         ^^^^^^^^^^^^^^^^^
82 |         }
83 |     },
   |

E501 Line too long (91 > 88)
  --> generate_api_network_ghap.py:86:89
   |
84 |     {
85 |         "goal": "Debug SSL certificate verification failures on production API",
86 |         "hypothesis": "Certificate expired or hostname mismatch in production environment",
   |                                                                                         ^^^
87 |         "action": "Check certificate validity and common name against actual hostname",
88 |         "prediction": "Will find expired cert or CN mismatch causing verification failure",
   |

E501 Line too long (91 > 88)
  --> generate_api_network_ghap.py:88:89
   |
86 |         "hypothesis": "Certificate expired or hostname mismatch in production environment",
87 |         "action": "Check certificate validity and common name against actual hostname",
88 |         "prediction": "Will find expired cert or CN mismatch causing verification failure",
   |                                                                                         ^^^
89 |         "strategy": Strategy.READ_THE_ERROR,
90 |         "outcome": "confirmed",
   |

E501 Line too long (104 > 88)
  --> generate_api_network_ghap.py:91:89
   |
89 |         "strategy": Strategy.READ_THE_ERROR,
90 |         "outcome": "confirmed",
91 |         "result": "Production cert CN was '*.api.example.com' but we were calling 'api-v2.example.com'",
   |                                                                                         ^^^^^^^^^^^^^^^^
92 |         "lesson": {
93 |             "what_worked": "Examined SSLError details, found CN mismatch, updated hostname to match wildcard pattern",
   |

E501 Line too long (118 > 88)
  --> generate_api_network_ghap.py:93:89
   |
91 |         "result": "Production cert CN was '*.api.example.com' but we were calling 'api-v2.example.com'",
92 |         "lesson": {
93 |             "what_worked": "Examined SSLError details, found CN mismatch, updated hostname to match wildcard pattern",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
94 |             "takeaway": "SSL errors often indicate hostname/cert mismatch - verify CN matches request hostname"
95 |         }
   |

E501 Line too long (111 > 88)
  --> generate_api_network_ghap.py:94:89
   |
92 |         "lesson": {
93 |             "what_worked": "Examined SSLError details, found CN mismatch, updated hostname to match wildcard pattern",
94 |             "takeaway": "SSL errors often indicate hostname/cert mismatch - verify CN matches request hostname"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^
95 |         }
96 |     },
   |

E501 Line too long (91 > 88)
   --> generate_api_network_ghap.py:98:89
    |
 96 |     },
 97 |     {
 98 |         "goal": "Resolve DNS resolution timeouts causing intermittent connection failures",
    |                                                                                         ^^^
 99 |         "hypothesis": "DNS server is slow or unreliable causing timeout on name resolution",
100 |         "action": "Add DNS caching with aiodns to avoid repeated lookups",
    |

E501 Line too long (92 > 88)
   --> generate_api_network_ghap.py:99:89
    |
 97 |     {
 98 |         "goal": "Resolve DNS resolution timeouts causing intermittent connection failures",
 99 |         "hypothesis": "DNS server is slow or unreliable causing timeout on name resolution",
    |                                                                                         ^^^^
100 |         "action": "Add DNS caching with aiodns to avoid repeated lookups",
101 |         "prediction": "DNS cache will eliminate timeout by reusing resolved addresses",
    |

E501 Line too long (99 > 88)
   --> generate_api_network_ghap.py:104:89
    |
102 |         "strategy": Strategy.SYSTEMATIC_ELIMINATION,
103 |         "outcome": "confirmed",
104 |         "result": "Implemented aiodns with 5-minute TTL cache, DNS timeouts eliminated completely",
    |                                                                                         ^^^^^^^^^^^
105 |         "lesson": {
106 |             "what_worked": "DNS caching reduced resolution calls by 95%, all timeouts disappeared",
    |

E501 Line too long (99 > 88)
   --> generate_api_network_ghap.py:106:89
    |
104 |         "result": "Implemented aiodns with 5-minute TTL cache, DNS timeouts eliminated completely",
105 |         "lesson": {
106 |             "what_worked": "DNS caching reduced resolution calls by 95%, all timeouts disappeared",
    |                                                                                         ^^^^^^^^^^^
107 |             "takeaway": "DNS resolution is often overlooked bottleneck - implement caching for frequently accessed hosts"
108 |         }
    |

E501 Line too long (121 > 88)
   --> generate_api_network_ghap.py:107:89
    |
105 |         "lesson": {
106 |             "what_worked": "DNS caching reduced resolution calls by 95%, all timeouts disappeared",
107 |             "takeaway": "DNS resolution is often overlooked bottleneck - implement caching for frequently accessed hosts"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
108 |         }
109 |     },
    |

E501 Line too long (139 > 88)
   --> generate_api_network_ghap.py:121:89
    |
119 | …
120 | …
121 | …zation: Bearer <token>' but we were sending 'Authorization: <token>' without Bearer prefix"
    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
122 | …
123 | …
    |

E501 Line too long (109 > 88)
   --> generate_api_network_ghap.py:124:89
    |
122 |         },
123 |         "lesson": {
124 |             "what_worked": "Checked request headers against API docs, added 'Bearer' prefix, auth works now",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^
125 |             "takeaway": "Authorization header format matters - verify exact format required by API"
126 |         }
    |

E501 Line too long (99 > 88)
   --> generate_api_network_ghap.py:125:89
    |
123 |         "lesson": {
124 |             "what_worked": "Checked request headers against API docs, added 'Bearer' prefix, auth works now",
125 |             "takeaway": "Authorization header format matters - verify exact format required by API"
    |                                                                                         ^^^^^^^^^^^
126 |         }
127 |     },
    |

E501 Line too long (92 > 88)
   --> generate_api_network_ghap.py:130:89
    |
128 |     {
129 |         "goal": "Debug slow API response times averaging 5+ seconds per request",
130 |         "hypothesis": "Server-side processing is slow, nothing we can optimize client-side",
    |                                                                                         ^^^^
131 |         "action": "Add request timing instrumentation to identify bottlenecks",
132 |         "prediction": "Will confirm server processing is the bottleneck",
    |

E501 Line too long (92 > 88)
   --> generate_api_network_ghap.py:135:89
    |
133 |         "strategy": Strategy.ROOT_CAUSE_ANALYSIS,
134 |         "outcome": "falsified",
135 |         "result": "Timing showed 4.8s in connection establishment, only 0.2s in processing",
    |                                                                                         ^^^^
136 |         "surprise": "Server was fast, connection setup was the bottleneck",
137 |         "root_cause": {
    |

E501 Line too long (117 > 88)
   --> generate_api_network_ghap.py:139:89
    |
137 |         "root_cause": {
138 |             "category": "wrong_hypothesis",
139 |             "description": "Connection pooling was disabled so every request did full TLS handshake - extremely slow"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
140 |         },
141 |         "lesson": {
    |

E501 Line too long (104 > 88)
   --> generate_api_network_ghap.py:142:89
    |
140 |         },
141 |         "lesson": {
142 |             "what_worked": "Enabled connection pooling with keep-alive, response time dropped to 200ms",
    |                                                                                         ^^^^^^^^^^^^^^^^
143 |             "takeaway": "Profile request lifecycle - connection overhead often exceeds processing time"
144 |         }
    |

E501 Line too long (103 > 88)
   --> generate_api_network_ghap.py:143:89
    |
141 |         "lesson": {
142 |             "what_worked": "Enabled connection pooling with keep-alive, response time dropped to 200ms",
143 |             "takeaway": "Profile request lifecycle - connection overhead often exceeds processing time"
    |                                                                                         ^^^^^^^^^^^^^^^
144 |         }
145 |     },
    |

E501 Line too long (89 > 88)
   --> generate_api_network_ghap.py:147:89
    |
145 |     },
146 |     {
147 |         "goal": "Resolve API returning stale data despite cache headers saying no-cache",
    |                                                                                         ^
148 |         "hypothesis": "Intermediate proxy is caching despite no-cache directive",
149 |         "action": "Add unique query parameter to bust any intermediate caches",
    |

E501 Line too long (95 > 88)
   --> generate_api_network_ghap.py:155:89
    |
153 |         "result": "Added timestamp query param, all responses now fresh",
154 |         "lesson": {
155 |             "what_worked": "Query param bypassed aggressive proxy caching we couldn't control",
    |                                                                                         ^^^^^^^
156 |             "takeaway": "When cache headers fail, query param cache-busting forces fresh responses"
157 |         }
    |

E501 Line too long (99 > 88)
   --> generate_api_network_ghap.py:156:89
    |
154 |         "lesson": {
155 |             "what_worked": "Query param bypassed aggressive proxy caching we couldn't control",
156 |             "takeaway": "When cache headers fail, query param cache-busting forces fresh responses"
    |                                                                                         ^^^^^^^^^^^
157 |         }
158 |     },
    |

E501 Line too long (98 > 88)
   --> generate_api_network_ghap.py:166:89
    |
164 |         "strategy": Strategy.READ_THE_ERROR,
165 |         "outcome": "confirmed",
166 |         "result": "Added explicit await response.aread() before json parsing, truncation stopped",
    |                                                                                         ^^^^^^^^^^
167 |         "lesson": {
168 |             "what_worked": "Forcing complete body read before parsing handled chunked encoding correctly",
    |

E501 Line too long (106 > 88)
   --> generate_api_network_ghap.py:168:89
    |
166 |         "result": "Added explicit await response.aread() before json parsing, truncation stopped",
167 |         "lesson": {
168 |             "what_worked": "Forcing complete body read before parsing handled chunked encoding correctly",
    |                                                                                         ^^^^^^^^^^^^^^^^^^
169 |             "takeaway": "Async HTTP clients need explicit body read for chunked responses"
170 |         }
    |

E501 Line too long (90 > 88)
   --> generate_api_network_ghap.py:169:89
    |
167 |         "lesson": {
168 |             "what_worked": "Forcing complete body read before parsing handled chunked encoding correctly",
169 |             "takeaway": "Async HTTP clients need explicit body read for chunked responses"
    |                                                                                         ^^
170 |         }
171 |     },
    |

E501 Line too long (108 > 88)
   --> generate_api_network_ghap.py:179:89
    |
177 |         "strategy": Strategy.CHECK_ASSUMPTIONS,
178 |         "outcome": "confirmed",
179 |         "result": "httpx wasn't auto-setting Content-Length for streaming bodies, explicit header fixed it",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^
180 |         "lesson": {
181 |             "what_worked": "Manual Content-Length calculation for streaming request bodies resolved 411 errors",
    |

E501 Line too long (112 > 88)
   --> generate_api_network_ghap.py:181:89
    |
179 |         "result": "httpx wasn't auto-setting Content-Length for streaming bodies, explicit header fixed it",
180 |         "lesson": {
181 |             "what_worked": "Manual Content-Length calculation for streaming request bodies resolved 411 errors",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^
182 |             "takeaway": "Streaming request bodies may need explicit Content-Length header"
183 |         }
    |

E501 Line too long (90 > 88)
   --> generate_api_network_ghap.py:182:89
    |
180 |         "lesson": {
181 |             "what_worked": "Manual Content-Length calculation for streaming request bodies resolved 411 errors",
182 |             "takeaway": "Streaming request bodies may need explicit Content-Length header"
    |                                                                                         ^^
183 |         }
184 |     },
    |

E501 Line too long (92 > 88)
   --> generate_api_network_ghap.py:188:89
    |
186 |         "goal": "Resolve API WebSocket connection dropping after exactly 60 seconds",
187 |         "hypothesis": "Server-side idle timeout disconnecting inactive connections",
188 |         "action": "Implement ping/pong heartbeat every 30 seconds to keep connection alive",
    |                                                                                         ^^^^
189 |         "prediction": "Heartbeat will prevent idle timeout disconnections",
190 |         "strategy": Strategy.DIVIDE_AND_CONQUER,
    |

E501 Line too long (105 > 88)
   --> generate_api_network_ghap.py:194:89
    |
192 |         "result": "Added 30s ping interval, connections now stable for hours",
193 |         "lesson": {
194 |             "what_worked": "Regular heartbeat prevents idle timeout on long-lived WebSocket connections",
    |                                                                                         ^^^^^^^^^^^^^^^^^
195 |             "takeaway": "WebSocket connections need periodic activity to avoid idle timeouts"
196 |         }
    |

E501 Line too long (93 > 88)
   --> generate_api_network_ghap.py:195:89
    |
193 |         "lesson": {
194 |             "what_worked": "Regular heartbeat prevents idle timeout on long-lived WebSocket connections",
195 |             "takeaway": "WebSocket connections need periodic activity to avoid idle timeouts"
    |                                                                                         ^^^^^
196 |         }
197 |     },
    |

E501 Line too long (92 > 88)
   --> generate_api_network_ghap.py:208:89
    |
207 |     collector = ObservationCollector()
208 |     persister = ObservationPersister(vector_store=vector_store, embedding_service=embedding)
    |                                                                                         ^^^^
209 |
210 |     print(f"Generating {len(GHAP_ENTRIES)} GHAP entries for API and network debugging...")
    |

E501 Line too long (90 > 88)
   --> generate_api_network_ghap.py:210:89
    |
208 |     persister = ObservationPersister(vector_store=vector_store, embedding_service=embedding)
209 |
210 |     print(f"Generating {len(GHAP_ENTRIES)} GHAP entries for API and network debugging...")
    |                                                                                         ^^
211 |
212 |     for i, entry_data in enumerate(GHAP_ENTRIES, 1):
    |

E501 Line too long (120 > 88)
   --> generate_api_network_ghap.py:271:89
    |
270 |     print(f"\nSuccessfully generated {len(GHAP_ENTRIES)} GHAP entries!")
271 |     print("All entries focused on: API debugging, network issues, timeouts, rate limiting, SSL/TLS, connection pooling")
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |

I001 [*] Import block is un-sorted or un-formatted
  --> generate_db_debugging_ghap.py:3:1
   |
 1 |   """Generate 12 GHAP entries for database and data layer debugging theme."""
 2 |
 3 | / import asyncio
 4 | | import random
 5 | | from datetime import datetime
 6 | |
 7 | | from clams.observation import (
 8 | |     Domain,
 9 | |     Lesson,
10 | |     ObservationCollector,
11 | |     ObservationPersister,
12 | |     OutcomeStatus,
13 | |     RootCause,
14 | |     Strategy,
15 | | )
16 | | from clams.storage.qdrant import QdrantVectorStore
17 | | from clams.embedding import NomicEmbedding
   | |__________________________________________^
   |
help: Organize imports

F401 [*] `random` imported but unused
 --> generate_db_debugging_ghap.py:4:8
  |
3 | import asyncio
4 | import random
  |        ^^^^^^
5 | from datetime import datetime
  |
help: Remove unused import: `random`

F401 [*] `datetime.datetime` imported but unused
 --> generate_db_debugging_ghap.py:5:22
  |
3 | import asyncio
4 | import random
5 | from datetime import datetime
  |                      ^^^^^^^^
6 |
7 | from clams.observation import (
  |
help: Remove unused import: `datetime.datetime`

E501 Line too long (93 > 88)
  --> generate_db_debugging_ghap.py:24:89
   |
22 |     {
23 |         "goal": "Fix N+1 query problem causing severe API slowdown",
24 |         "hypothesis": "ORM lazy loading triggers individual queries for each related object",
   |                                                                                         ^^^^^
25 |         "action": "Add eager loading with select_related() for foreign keys",
26 |         "prediction": "Query count will drop from 1000+ to under 10 per request",
   |

E501 Line too long (126 > 88)
  --> generate_db_debugging_ghap.py:29:89
   |
27 |         "strategy": Strategy.ROOT_CAUSE_ANALYSIS,
28 |         "outcome": "confirmed",
29 |         "result": "Added select_related('user', 'category') - queries dropped from 1203 to 3, response time from 8s to 120ms",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
30 |         "lesson": {
31 |             "what_worked": "Django debug toolbar revealed N+1, select_related eliminated extra queries",
   |

E501 Line too long (104 > 88)
  --> generate_db_debugging_ghap.py:31:89
   |
29 |         "result": "Added select_related('user', 'category') - queries dropped from 1203 to 3, response time from 8s to 120ms",
30 |         "lesson": {
31 |             "what_worked": "Django debug toolbar revealed N+1, select_related eliminated extra queries",
   |                                                                                         ^^^^^^^^^^^^^^^^
32 |             "takeaway": "Always use select_related() or prefetch_related() when accessing foreign key relationships in loops"
33 |         }
   |

E501 Line too long (125 > 88)
  --> generate_db_debugging_ghap.py:32:89
   |
30 |         "lesson": {
31 |             "what_worked": "Django debug toolbar revealed N+1, select_related eliminated extra queries",
32 |             "takeaway": "Always use select_related() or prefetch_related() when accessing foreign key relationships in loops"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
33 |         }
34 |     },
   |

E501 Line too long (104 > 88)
  --> generate_db_debugging_ghap.py:42:89
   |
40 |         "strategy": Strategy.SYSTEMATIC_ELIMINATION,
41 |         "outcome": "confirmed",
42 |         "result": "Found 3 exception handlers that failed to release connections, added proper cleanup",
   |                                                                                         ^^^^^^^^^^^^^^^^
43 |         "lesson": {
44 |             "what_worked": "Connection pool monitoring showed gradual exhaustion, traced to exception paths",
   |

E501 Line too long (109 > 88)
  --> generate_db_debugging_ghap.py:44:89
   |
42 |         "result": "Found 3 exception handlers that failed to release connections, added proper cleanup",
43 |         "lesson": {
44 |             "what_worked": "Connection pool monitoring showed gradual exhaustion, traced to exception paths",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^
45 |             "takeaway": "Always use context managers or try/finally blocks to guarantee connection cleanup, especially in error paths"
46 |         }
   |

E501 Line too long (134 > 88)
  --> generate_db_debugging_ghap.py:45:89
   |
43 |         "lesson": {
44 |             "what_worked": "Connection pool monitoring showed gradual exhaustion, traced to exception paths",
45 |             "takeaway": "Always use context managers or try/finally blocks to guarantee connection cleanup, especially in error paths"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
46 |         }
47 |     },
   |

E501 Line too long (99 > 88)
  --> generate_db_debugging_ghap.py:51:89
   |
49 |         "goal": "Resolve transaction deadlocks occurring during concurrent updates",
50 |         "hypothesis": "Two transactions acquiring row locks in different orders",
51 |         "action": "Standardize lock acquisition order by primary key across all update operations",
   |                                                                                         ^^^^^^^^^^^
52 |         "prediction": "Deadlocks will cease after enforcing consistent ordering",
53 |         "strategy": Strategy.ROOT_CAUSE_ANALYSIS,
   |

E501 Line too long (176 > 88)
  --> generate_db_debugging_ghap.py:59:89
   |
57 | …
58 | …
59 | …uiring gap locks in different orders based on WHERE clause order - needed to order by PK in the SELECT itself"
   |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
60 | …
61 | …
   |

E501 Line too long (102 > 88)
  --> generate_db_debugging_ghap.py:62:89
   |
60 | …     },
61 | …     "lesson": {
62 | …         "what_worked": "Added ORDER BY id to all SELECT FOR UPDATE queries, deadlocks eliminated",
   |                                                                                       ^^^^^^^^^^^^^^
63 | …         "takeaway": "Gap locks from range queries can deadlock - always use ORDER BY in SELECT FOR UPDATE to ensure consistent lock …
64 | …     }
   |

E501 Line too long (145 > 88)
  --> generate_db_debugging_ghap.py:63:89
   |
61 | …
62 | …ll SELECT FOR UPDATE queries, deadlocks eliminated",
63 | …ies can deadlock - always use ORDER BY in SELECT FOR UPDATE to ensure consistent lock ordering"
   |                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
64 | …
65 | …
   |

E501 Line too long (112 > 88)
  --> generate_db_debugging_ghap.py:73:89
   |
71 |         "strategy": Strategy.CHECK_ASSUMPTIONS,
72 |         "outcome": "confirmed",
73 |         "result": "Added composite index on (created_at, status, user_id), query time dropped from 45s to 0.3s",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^
74 |         "lesson": {
75 |             "what_worked": "EXPLAIN ANALYZE showed sequential scan, composite index enabled index-only scan",
   |

E501 Line too long (109 > 88)
  --> generate_db_debugging_ghap.py:75:89
   |
73 |         "result": "Added composite index on (created_at, status, user_id), query time dropped from 45s to 0.3s",
74 |         "lesson": {
75 |             "what_worked": "EXPLAIN ANALYZE showed sequential scan, composite index enabled index-only scan",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^
76 |             "takeaway": "Always check query plans with EXPLAIN before adding indexes - composite indexes for multi-column filters"
77 |         }
   |

E501 Line too long (130 > 88)
  --> generate_db_debugging_ghap.py:76:89
   |
74 |         "lesson": {
75 |             "what_worked": "EXPLAIN ANALYZE showed sequential scan, composite index enabled index-only scan",
76 |             "takeaway": "Always check query plans with EXPLAIN before adding indexes - composite indexes for multi-column filters"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
77 |         }
78 |     },
   |

E501 Line too long (155 > 88)
  --> generate_db_debugging_ghap.py:90:89
   |
88 | …
89 | …
90 | …data from database read replicas with replication lag - cache was correct but source data was stale"
   |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
91 | …
92 | …
   |

E501 Line too long (122 > 88)
  --> generate_db_debugging_ghap.py:93:89
   |
91 |         },
92 |         "lesson": {
93 |             "what_worked": "Added read-your-writes consistency by routing updates to primary, replication lag monitoring",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
94 |             "takeaway": "Consider replication lag when debugging cache issues - stale replica reads can appear as cache problems"
95 |         }
   |

E501 Line too long (129 > 88)
  --> generate_db_debugging_ghap.py:94:89
   |
92 |         "lesson": {
93 |             "what_worked": "Added read-your-writes consistency by routing updates to primary, replication lag monitoring",
94 |             "takeaway": "Consider replication lag when debugging cache issues - stale replica reads can appear as cache problems"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
95 |         }
96 |     },
   |

E501 Line too long (99 > 88)
   --> generate_db_debugging_ghap.py:106:89
    |
104 |         "result": "Set max_idle_time from 3600s to 300s, connection leaks disappeared",
105 |         "lesson": {
106 |             "what_worked": "Aggressive timeout recycled leaked connections before pool exhaustion",
    |                                                                                         ^^^^^^^^^^^
107 |             "takeaway": "Set conservative connection timeouts to compensate for application bugs that leak connections"
108 |         }
    |

E501 Line too long (119 > 88)
   --> generate_db_debugging_ghap.py:107:89
    |
105 |         "lesson": {
106 |             "what_worked": "Aggressive timeout recycled leaked connections before pool exhaustion",
107 |             "takeaway": "Set conservative connection timeouts to compensate for application bugs that leak connections"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
108 |         }
109 |     },
    |

E501 Line too long (104 > 88)
   --> generate_db_debugging_ghap.py:117:89
    |
115 |         "strategy": Strategy.CHECK_ASSUMPTIONS,
116 |         "outcome": "confirmed",
117 |         "result": "Changed to bulk_create(batch_size=1000), time dropped from 3h to 4min for 100k rows",
    |                                                                                         ^^^^^^^^^^^^^^^^
118 |         "lesson": {
119 |             "what_worked": "Bulk insert with batching amortized transaction overhead across many rows",
    |

E501 Line too long (103 > 88)
   --> generate_db_debugging_ghap.py:119:89
    |
117 |         "result": "Changed to bulk_create(batch_size=1000), time dropped from 3h to 4min for 100k rows",
118 |         "lesson": {
119 |             "what_worked": "Bulk insert with batching amortized transaction overhead across many rows",
    |                                                                                         ^^^^^^^^^^^^^^^
120 |             "takeaway": "Use bulk operations for large datasets - batch_size prevents memory bloat and transaction size issues"
121 |         }
    |

E501 Line too long (127 > 88)
   --> generate_db_debugging_ghap.py:120:89
    |
118 |         "lesson": {
119 |             "what_worked": "Bulk insert with batching amortized transaction overhead across many rows",
120 |             "takeaway": "Use bulk operations for large datasets - batch_size prevents memory bloat and transaction size issues"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
121 |         }
122 |     },
    |

E501 Line too long (160 > 88)
   --> generate_db_debugging_ghap.py:134:89
    |
132 | …
133 | …
134 | …nullable to NOT NULL with default value, existing NULL rows got default value breaking business logic"
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
135 | …
136 | …
    |

E501 Line too long (129 > 88)
   --> generate_db_debugging_ghap.py:137:89
    |
135 |         },
136 |         "lesson": {
137 |             "what_worked": "Compared pre/post migration data, found NULL -> default conversions, backfilled with correct values",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
138 |             "takeaway": "Validate data integrity after schema migrations, especially NULL handling changes"
139 |         }
    |

E501 Line too long (107 > 88)
   --> generate_db_debugging_ghap.py:138:89
    |
136 |         "lesson": {
137 |             "what_worked": "Compared pre/post migration data, found NULL -> default conversions, backfilled with correct values",
138 |             "takeaway": "Validate data integrity after schema migrations, especially NULL handling changes"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^
139 |         }
140 |     },
    |

E501 Line too long (104 > 88)
   --> generate_db_debugging_ghap.py:150:89
    |
148 |         "result": "Wrapped delete operations in transaction, violations eliminated",
149 |         "lesson": {
150 |             "what_worked": "Transaction isolation prevented race between parent delete and child query",
    |                                                                                         ^^^^^^^^^^^^^^^^
151 |             "takeaway": "Always use transactions for multi-table operations with referential integrity requirements"
152 |         }
    |

E501 Line too long (116 > 88)
   --> generate_db_debugging_ghap.py:151:89
    |
149 |         "lesson": {
150 |             "what_worked": "Transaction isolation prevented race between parent delete and child query",
151 |             "takeaway": "Always use transactions for multi-table operations with referential integrity requirements"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
152 |         }
153 |     },
    |

E501 Line too long (96 > 88)
   --> generate_db_debugging_ghap.py:161:89
    |
159 |         "strategy": Strategy.SYSTEMATIC_ELIMINATION,
160 |         "outcome": "confirmed",
161 |         "result": "Replaced 3-level nested subquery with JOIN, execution time from 12s to 0.8s",
    |                                                                                         ^^^^^^^^
162 |         "lesson": {
163 |             "what_worked": "Raw SQL analysis showed unnecessary nesting, refactored to use annotate() with joins",
    |

E501 Line too long (114 > 88)
   --> generate_db_debugging_ghap.py:163:89
    |
161 |         "result": "Replaced 3-level nested subquery with JOIN, execution time from 12s to 0.8s",
162 |         "lesson": {
163 |             "what_worked": "Raw SQL analysis showed unnecessary nesting, refactored to use annotate() with joins",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
164 |             "takeaway": "Review generated SQL for complex querysets - sometimes manual query construction is clearer and faster"
165 |         }
    |

E501 Line too long (128 > 88)
   --> generate_db_debugging_ghap.py:164:89
    |
162 |         "lesson": {
163 |             "what_worked": "Raw SQL analysis showed unnecessary nesting, refactored to use annotate() with joins",
164 |             "takeaway": "Review generated SQL for complex querysets - sometimes manual query construction is clearer and faster"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
165 |         }
166 |     },
    |

E501 Line too long (141 > 88)
   --> generate_db_debugging_ghap.py:178:89
    |
176 | …
177 | …
178 | …instances each with their own pools - total connections across all instances exceeded limit"
    |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
179 | …
180 | …
    |

E501 Line too long (136 > 88)
   --> generate_db_debugging_ghap.py:181:89
    |
179 | …
180 | …
181 | …s (pool_size × instance_count), set per-instance pool = max_connections / instance_count",
    |                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
182 | …s must account for all application instances, not just one"
183 | …
    |

E501 Line too long (105 > 88)
   --> generate_db_debugging_ghap.py:182:89
    |
180 |         "lesson": {
181 |             "what_worked": "Calculated total as (pool_size × instance_count), set per-instance pool = max_connections / instance_coun…
182 |             "takeaway": "Connection pool limits must account for all application instances, not just one"
    |                                                                                         ^^^^^^^^^^^^^^^^^
183 |         }
184 |     },
    |

E501 Line too long (91 > 88)
   --> generate_db_debugging_ghap.py:192:89
    |
190 |         "strategy": Strategy.ROOT_CAUSE_ANALYSIS,
191 |         "outcome": "confirmed",
192 |         "result": "Set REPEATABLE READ for critical transactions, lost updates eliminated",
    |                                                                                         ^^^
193 |         "lesson": {
194 |             "what_worked": "Higher isolation level prevented phantom reads during read-modify-write cycles",
    |

E501 Line too long (108 > 88)
   --> generate_db_debugging_ghap.py:194:89
    |
192 |         "result": "Set REPEATABLE READ for critical transactions, lost updates eliminated",
193 |         "lesson": {
194 |             "what_worked": "Higher isolation level prevented phantom reads during read-modify-write cycles",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^
195 |             "takeaway": "Use REPEATABLE READ or SERIALIZABLE for read-modify-write patterns to prevent lost updates"
196 |         }
    |

E501 Line too long (116 > 88)
   --> generate_db_debugging_ghap.py:195:89
    |
193 |         "lesson": {
194 |             "what_worked": "Higher isolation level prevented phantom reads during read-modify-write cycles",
195 |             "takeaway": "Use REPEATABLE READ or SERIALIZABLE for read-modify-write patterns to prevent lost updates"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
196 |         }
197 |     },
    |

E501 Line too long (92 > 88)
   --> generate_db_debugging_ghap.py:208:89
    |
207 |     collector = ObservationCollector()
208 |     persister = ObservationPersister(vector_store=vector_store, embedding_service=embedding)
    |                                                                                         ^^^^
209 |
210 |     print(f"Generating {len(GHAP_ENTRIES)} GHAP entries for database/data layer debugging...")
    |

E501 Line too long (94 > 88)
   --> generate_db_debugging_ghap.py:210:89
    |
208 |     persister = ObservationPersister(vector_store=vector_store, embedding_service=embedding)
209 |
210 |     print(f"Generating {len(GHAP_ENTRIES)} GHAP entries for database/data layer debugging...")
    |                                                                                         ^^^^^^
211 |
212 |     for i, entry_data in enumerate(GHAP_ENTRIES, 1):
    |

E501 Line too long (101 > 88)
   --> generate_db_debugging_ghap.py:224:89
    |
222 |             )
223 |
224 |             print(f"[{i}/{len(GHAP_ENTRIES)}] Created GHAP {entry.id}: {entry_data['goal'][:60]}...")
    |                                                                                         ^^^^^^^^^^^^^
225 |
226 |             # Prepare outcome data
    |

E501 Line too long (122 > 88)
   --> generate_db_debugging_ghap.py:271:89
    |
270 |     print(f"\nSuccessfully generated {len(GHAP_ENTRIES)} GHAP entries!")
271 |     print("All entries focused on: database debugging, N+1 queries, connection management, deadlocks, query optimization")
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |

I001 [*] Import block is un-sorted or un-formatted
  --> generate_testing_ghaps.py:4:1
   |
 2 |   """Generate 12 GHAP entries focused on debugging testing and CI/CD issues."""
 3 |
 4 | / import asyncio
 5 | |
 6 | | from clams.observation import (
 7 | |     Domain,
 8 | |     ObservationCollector,
 9 | |     ObservationPersister,
10 | |     OutcomeStatus,
11 | |     RootCause,
12 | |     Lesson,
13 | |     Strategy,
14 | | )
15 | | from clams.embedding import NomicEmbedding
16 | | from clams.storage.qdrant import QdrantVectorStore
   | |__________________________________________________^
   |
help: Organize imports

E501 Line too long (92 > 88)
  --> generate_testing_ghaps.py:26:89
   |
24 |     vector_store = QdrantVectorStore()
25 |     collector = ObservationCollector()
26 |     persister = ObservationPersister(vector_store=vector_store, embedding_service=embedding)
   |                                                                                         ^^^^
27 |
28 |     # GHAP 1: Flaky test with race condition (confirmed)
   |

E501 Line too long (99 > 88)
  --> generate_testing_ghaps.py:33:89
   |
31 |         strategy=Strategy.ROOT_CAUSE_ANALYSIS,
32 |         goal="Fix intermittent failure in test_session_cleanup",
33 |         hypothesis="Test fails because cleanup worker thread doesn't finish before assertions run",
   |                                                                                         ^^^^^^^^^^^
34 |         action="Add thread synchronization with join() and verify cleanup completion",
35 |         prediction="Test will pass consistently when cleanup thread is properly synchronized"
   |

E501 Line too long (93 > 88)
  --> generate_testing_ghaps.py:35:89
   |
33 |         hypothesis="Test fails because cleanup worker thread doesn't finish before assertions run",
34 |         action="Add thread synchronization with join() and verify cleanup completion",
35 |         prediction="Test will pass consistently when cleanup thread is properly synchronized"
   |                                                                                         ^^^^^
36 |     )
37 |     resolved1 = await collector.resolve_ghap(
   |

E501 Line too long (98 > 88)
  --> generate_testing_ghaps.py:39:89
   |
37 |     resolved1 = await collector.resolve_ghap(
38 |         status=OutcomeStatus.CONFIRMED,
39 |         result="Added threading.Event to signal cleanup completion, test now passes 100/100 runs",
   |                                                                                         ^^^^^^^^^^
40 |         lesson=Lesson(
41 |             what_worked="Using Event.wait(timeout=5) to ensure cleanup finishes before assertions",
   |

E501 Line too long (99 > 88)
  --> generate_testing_ghaps.py:41:89
   |
39 |         result="Added threading.Event to signal cleanup completion, test now passes 100/100 runs",
40 |         lesson=Lesson(
41 |             what_worked="Using Event.wait(timeout=5) to ensure cleanup finishes before assertions",
   |                                                                                         ^^^^^^^^^^^
42 |             takeaway="Always synchronize with background threads in tests using events or joins"
43 |         )
   |

E501 Line too long (96 > 88)
  --> generate_testing_ghaps.py:42:89
   |
40 |         lesson=Lesson(
41 |             what_worked="Using Event.wait(timeout=5) to ensure cleanup finishes before assertions",
42 |             takeaway="Always synchronize with background threads in tests using events or joins"
   |                                                                                         ^^^^^^^^
43 |         )
44 |     )
   |

E501 Line too long (89 > 88)
  --> generate_testing_ghaps.py:53:89
   |
51 |         strategy=Strategy.CHECK_ASSUMPTIONS,
52 |         goal="Fix test_api_call failure where mock never gets called",
53 |         hypothesis="Mock patch path is incorrect, should be where it's used not defined",
   |                                                                                         ^
54 |         action="Change @patch('module.api') to @patch('tested_module.api')",
55 |         prediction="Mock will be called when patched at import location"
   |

E501 Line too long (113 > 88)
  --> generate_testing_ghaps.py:59:89
   |
57 |     resolved2 = await collector.resolve_ghap(
58 |         status=OutcomeStatus.FALSIFIED,
59 |         result="Patch path was correct. Real issue was test calling old cached instance before mock was set up.",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^
60 |         surprise="Mock path was fine, but instance caching bypassed the mock entirely",
61 |         root_cause=RootCause(
   |

E501 Line too long (106 > 88)
  --> generate_testing_ghaps.py:63:89
   |
61 |         root_cause=RootCause(
62 |             category="wrong-assumption",
63 |             description="Focused on patch location when real issue was singleton cache loaded before test"
   |                                                                                         ^^^^^^^^^^^^^^^^^^
64 |         ),
65 |         lesson=Lesson(
   |

E501 Line too long (104 > 88)
  --> generate_testing_ghaps.py:84:89
   |
82 |     resolved3 = await collector.resolve_ghap(
83 |         status=OutcomeStatus.CONFIRMED,
84 |         result="Found test_database_migration taking 18 minutes. Split into unit tests with mocked DB.",
   |                                                                                         ^^^^^^^^^^^^^^^^
85 |         lesson=Lesson(
86 |             what_worked="pytest --durations=10 revealed the bottleneck immediately",
   |

E501 Line too long (104 > 88)
  --> generate_testing_ghaps.py:87:89
   |
85 |         lesson=Lesson(
86 |             what_worked="pytest --durations=10 revealed the bottleneck immediately",
87 |             takeaway="Profile test duration regularly, set --timeout per test to catch slow tests early"
   |                                                                                         ^^^^^^^^^^^^^^^^
88 |         )
89 |     )
   |

E501 Line too long (107 > 88)
   --> generate_testing_ghaps.py:104:89
    |
102 |     resolved4 = await collector.resolve_ghap(
103 |         status=OutcomeStatus.CONFIRMED,
104 |         result="Added DATABASE_URL to GitHub Actions secrets, updated .env.example with all required vars",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^
105 |         lesson=Lesson(
106 |             what_worked="Checking .env.example against actual code usage to find missing vars",
    |

E501 Line too long (95 > 88)
   --> generate_testing_ghaps.py:106:89
    |
104 |         result="Added DATABASE_URL to GitHub Actions secrets, updated .env.example with all required vars",
105 |         lesson=Lesson(
106 |             what_worked="Checking .env.example against actual code usage to find missing vars",
    |                                                                                         ^^^^^^^
107 |             takeaway="Maintain .env.example with all required variables, validate in CI setup"
108 |         )
    |

E501 Line too long (94 > 88)
   --> generate_testing_ghaps.py:107:89
    |
105 |         lesson=Lesson(
106 |             what_worked="Checking .env.example against actual code usage to find missing vars",
107 |             takeaway="Maintain .env.example with all required variables, validate in CI setup"
    |                                                                                         ^^^^^^
108 |         )
109 |     )
    |

E501 Line too long (130 > 88)
   --> generate_testing_ghaps.py:124:89
    |
122 |     resolved5 = await collector.resolve_ghap(
123 |         status=OutcomeStatus.FALSIFIED,
124 |         result="Database cleanup was fine. Issue was module-level import executing code that created test user before tests ran.",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
125 |         surprise="Test isolation issue was at import time, not during test execution",
126 |         root_cause=RootCause(
    |

E501 Line too long (90 > 88)
   --> generate_testing_ghaps.py:128:89
    |
126 |         root_cause=RootCause(
127 |             category="wrong-scope",
128 |             description="Looked at test cleanup when issue was module import side effects"
    |                                                                                         ^^
129 |         ),
130 |         lesson=Lesson(
    |

E501 Line too long (112 > 88)
   --> generate_testing_ghaps.py:131:89
    |
129 |         ),
130 |         lesson=Lesson(
131 |             what_worked="Moving code from module level to test fixtures eliminated the import-time side effect",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^
132 |             takeaway="Avoid code execution at module import - use fixtures or setUp instead"
133 |         )
    |

E501 Line too long (92 > 88)
   --> generate_testing_ghaps.py:132:89
    |
130 |         lesson=Lesson(
131 |             what_worked="Moving code from module level to test fixtures eliminated the import-time side effect",
132 |             takeaway="Avoid code execution at module import - use fixtures or setUp instead"
    |                                                                                         ^^^^
133 |         )
134 |     )
    |

E501 Line too long (91 > 88)
   --> generate_testing_ghaps.py:143:89
    |
141 |         strategy=Strategy.ROOT_CAUSE_ANALYSIS,
142 |         goal="Fix pytest fixture dependency causing test_api to fail",
143 |         hypothesis="Fixtures executing in wrong order, database not ready when API starts",
    |                                                                                         ^^^
144 |         action="Add explicit fixture dependencies: api_client depends on db_session",
145 |         prediction="Correct dependency order will ensure database is ready"
    |

E501 Line too long (104 > 88)
   --> generate_testing_ghaps.py:149:89
    |
147 |     resolved6 = await collector.resolve_ghap(
148 |         status=OutcomeStatus.CONFIRMED,
149 |         result="Changed @pytest.fixture to take db_session parameter, pytest now ensures correct order",
    |                                                                                         ^^^^^^^^^^^^^^^^
150 |         lesson=Lesson(
151 |             what_worked="Using fixture parameters to declare dependencies explicitly",
    |

E501 Line too long (99 > 88)
   --> generate_testing_ghaps.py:152:89
    |
150 |         lesson=Lesson(
151 |             what_worked="Using fixture parameters to declare dependencies explicitly",
152 |             takeaway="Declare fixture dependencies via parameters, don't rely on implicit ordering"
    |                                                                                         ^^^^^^^^^^^
153 |         )
154 |     )
    |

E501 Line too long (101 > 88)
   --> generate_testing_ghaps.py:169:89
    |
167 |     resolved7 = await collector.resolve_ghap(
168 |         status=OutcomeStatus.CONFIRMED,
169 |         result="Reordered Dockerfile, added GitHub Actions cache, build now 3 minutes instead of 15",
    |                                                                                         ^^^^^^^^^^^^^
170 |         lesson=Lesson(
171 |             what_worked="Copy requirements.txt first, then COPY . later so code changes don't invalidate dependency layer",
    |

E501 Line too long (123 > 88)
   --> generate_testing_ghaps.py:171:89
    |
169 |         result="Reordered Dockerfile, added GitHub Actions cache, build now 3 minutes instead of 15",
170 |         lesson=Lesson(
171 |             what_worked="Copy requirements.txt first, then COPY . later so code changes don't invalidate dependency layer",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
172 |             takeaway="Optimize Dockerfile layer order: least-changing files first, most-changing last"
173 |         )
    |

E501 Line too long (102 > 88)
   --> generate_testing_ghaps.py:172:89
    |
170 |         lesson=Lesson(
171 |             what_worked="Copy requirements.txt first, then COPY . later so code changes don't invalidate dependency layer",
172 |             takeaway="Optimize Dockerfile layer order: least-changing files first, most-changing last"
    |                                                                                         ^^^^^^^^^^^^^^
173 |         )
174 |     )
    |

E501 Line too long (113 > 88)
   --> generate_testing_ghaps.py:189:89
    |
187 |     resolved8 = await collector.resolve_ghap(
188 |         status=OutcomeStatus.FALSIFIED,
189 |         result="Test data was correct. Bug was in production code - edge case not handled for negative numbers.",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^
190 |         surprise="Test was correctly catching a real bug, not a test issue",
191 |         root_cause=RootCause(
    |

E501 Line too long (97 > 88)
   --> generate_testing_ghaps.py:193:89
    |
191 |         root_cause=RootCause(
192 |             category="wrong-assumption",
193 |             description="Assumed test was wrong when it was correctly identifying production bug"
    |                                                                                         ^^^^^^^^^
194 |         ),
195 |         lesson=Lesson(
    |

E501 Line too long (111 > 88)
   --> generate_testing_ghaps.py:196:89
    |
194 |         ),
195 |         lesson=Lesson(
196 |             what_worked="Stepping through test case revealed production code assumption about positive inputs",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^
197 |             takeaway="When one parametrized case fails, it may be finding a real bug, not test issue"
198 |         )
    |

E501 Line too long (101 > 88)
   --> generate_testing_ghaps.py:197:89
    |
195 |         lesson=Lesson(
196 |             what_worked="Stepping through test case revealed production code assumption about positive inputs",
197 |             takeaway="When one parametrized case fails, it may be finding a real bug, not test issue"
    |                                                                                         ^^^^^^^^^^^^^
198 |         )
199 |     )
    |

E501 Line too long (95 > 88)
   --> generate_testing_ghaps.py:214:89
    |
212 |     resolved9 = await collector.resolve_ghap(
213 |         status=OutcomeStatus.CONFIRMED,
214 |         result="Added @freeze_time('2024-01-15 10:00:00'), test now passes at any time of day",
    |                                                                                         ^^^^^^^
215 |         lesson=Lesson(
216 |             what_worked="freezegun library for simple time freezing in tests",
    |

E501 Line too long (90 > 88)
   --> generate_testing_ghaps.py:217:89
    |
215 |         lesson=Lesson(
216 |             what_worked="freezegun library for simple time freezing in tests",
217 |             takeaway="Never rely on real time in tests - use time mocking for determinism"
    |                                                                                         ^^
218 |         )
219 |     )
    |

E501 Line too long (107 > 88)
   --> generate_testing_ghaps.py:234:89
    |
232 |     resolved10 = await collector.resolve_ghap(
233 |         status=OutcomeStatus.CONFIRMED,
234 |         result="Found match statement (3.10+) and union types (3.10+). Replaced with if/elif and Union[].",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^
235 |         lesson=Lesson(
236 |             what_worked="Error trace showed SyntaxError pointing directly to match statement",
    |

E501 Line too long (94 > 88)
   --> generate_testing_ghaps.py:236:89
    |
234 |         result="Found match statement (3.10+) and union types (3.10+). Replaced with if/elif and Union[].",
235 |         lesson=Lesson(
236 |             what_worked="Error trace showed SyntaxError pointing directly to match statement",
    |                                                                                         ^^^^^^
237 |             takeaway="Check minimum Python version in CI matrix matches project requirements"
238 |         )
    |

E501 Line too long (93 > 88)
   --> generate_testing_ghaps.py:237:89
    |
235 |         lesson=Lesson(
236 |             what_worked="Error trace showed SyntaxError pointing directly to match statement",
237 |             takeaway="Check minimum Python version in CI matrix matches project requirements"
    |                                                                                         ^^^^^
238 |         )
239 |     )
    |

E501 Line too long (131 > 88)
   --> generate_testing_ghaps.py:254:89
    |
252 |     resolved11 = await collector.resolve_ghap(
253 |         status=OutcomeStatus.FALSIFIED,
254 |         result="Coverage was actually 86% locally. CI failure was because it included migration files. Fixed .coveragerc exclude.",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
255 |         surprise="Coverage was passing threshold, but CI included files it shouldn't",
256 |         root_cause=RootCause(
    |

E501 Line too long (107 > 88)
   --> generate_testing_ghaps.py:258:89
    |
256 |         root_cause=RootCause(
257 |             category="wrong-scope",
258 |             description="Assumed missing tests when issue was coverage configuration including wrong files"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^
259 |         ),
260 |         lesson=Lesson(
    |

E501 Line too long (107 > 88)
   --> generate_testing_ghaps.py:261:89
    |
259 |         ),
260 |         lesson=Lesson(
261 |             what_worked="Comparing local coverage output with CI to spot the difference in included files",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^
262 |             takeaway="Ensure .coveragerc omit patterns match between local and CI environments"
263 |         )
    |

E501 Line too long (95 > 88)
   --> generate_testing_ghaps.py:262:89
    |
260 |         lesson=Lesson(
261 |             what_worked="Comparing local coverage output with CI to spot the difference in included files",
262 |             takeaway="Ensure .coveragerc omit patterns match between local and CI environments"
    |                                                                                         ^^^^^^^
263 |         )
264 |     )
    |

E501 Line too long (101 > 88)
   --> generate_testing_ghaps.py:279:89
    |
277 |     resolved12 = await collector.resolve_ghap(
278 |         status=OutcomeStatus.CONFIRMED,
279 |         result="Found 5 file operations without context managers. Changed to 'with open()' pattern.",
    |                                                                                         ^^^^^^^^^^^^^
280 |         lesson=Lesson(
281 |             what_worked="pytest -Werror::ResourceWarning to make warnings fail tests, grep for 'open(' to find all cases",
    |

E501 Line too long (122 > 88)
   --> generate_testing_ghaps.py:281:89
    |
279 |         result="Found 5 file operations without context managers. Changed to 'with open()' pattern.",
280 |         lesson=Lesson(
281 |             what_worked="pytest -Werror::ResourceWarning to make warnings fail tests, grep for 'open(' to find all cases",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
282 |             takeaway="Always use context managers for resources (files, connections, locks)"
283 |         )
    |

E501 Line too long (92 > 88)
   --> generate_testing_ghaps.py:282:89
    |
280 |         lesson=Lesson(
281 |             what_worked="pytest -Werror::ResourceWarning to make warnings fail tests, grep for 'open(' to find all cases",
282 |             takeaway="Always use context managers for resources (files, connections, locks)"
    |                                                                                         ^^^^
283 |         )
284 |     )
    |

F401 [*] `starlette.routing.Mount` imported but unused
  --> src/clams/server/http.py:31:31
   |
29 | from starlette.requests import Request
30 | from starlette.responses import JSONResponse, Response
31 | from starlette.routing import Mount, Route
   |                               ^^^^^
32 |
33 | from clams.server.tools import ServiceContainer
   |
help: Remove unused import: `starlette.routing.Mount`

Found 176 errors.
[*] 10 fixable with the `--fix` option.

FAIL: Linter errors found
✗ Linter clean: FAIL

--- Gate: Type check clean ---
=== Running Type Checker ===
Directory: /Users/elliotmilco/Documents/GitHub/clams/.worktrees/BUG-065

Detected: Python
Running: mypy --strict (via uv run)
Success: no issues found in 64 source files

PASS: Type check clean
✓ Type check clean: PASS

==========================================
GATE RESULT: FAIL

Fix the failing gates before proceeding.
