=== Gate Check: IMPLEMENT-CODE_REVIEW ===
Task: SPEC-006
Worktree: /Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006


--- Gate: Implementation code exists ---
âœ“ Implementation code exists: PASS
Changed files:
  src/learning_memory_server/embedding/__init__.py
  src/learning_memory_server/embedding/minilm.py
  src/learning_memory_server/embedding/registry.py
  src/learning_memory_server/indexers/indexer.py
  src/learning_memory_server/server/config.py
  src/learning_memory_server/server/main.py
  src/learning_memory_server/server/tools/__init__.py
  src/learning_memory_server/server/tools/code.py
  src/learning_memory_server/server/tools/memory.py
  src/learning_memory_server/storage/__init__.py

--- Gate: Tests pass ---
=== Running Tests ===
Directory: /Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006
Task ID: SPEC-006

Detected: Python (pytest)

Syncing dependencies with uv...

Running tests...
============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-9.0.1, pluggy-1.6.0 -- /Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/.venv/bin/python
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: /Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006
configfile: pyproject.toml
testpaths: tests
plugins: mock-3.15.1, hypothesis-6.148.6, anyio-4.12.0, asyncio-1.3.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 551 items / 55 deselected / 496 selected

tests/clustering/test_clusterer.py::test_cluster_basic PASSED
tests/clustering/test_clusterer.py::test_cluster_with_weights PASSED
tests/clustering/test_clusterer.py::test_cluster_empty PASSED
tests/clustering/test_clusterer.py::test_cluster_wrong_shape PASSED
tests/clustering/test_clusterer.py::test_cluster_weights_mismatch PASSED
tests/clustering/test_clusterer.py::test_cluster_single_cluster PASSED
tests/clustering/test_clusterer.py::test_compute_centroids PASSED
tests/clustering/test_clusterer.py::test_compute_centroids_excludes_noise PASSED
tests/clustering/test_clusterer.py::test_compute_centroids_weighted PASSED
tests/clustering/test_clusterer.py::test_compute_centroids_array_mismatch PASSED
tests/clustering/test_clusterer.py::test_compute_centroids_weights_mismatch PASSED
tests/clustering/test_clusterer.py::test_compute_centroids_no_weights PASSED
tests/clustering/test_clusterer.py::test_cluster_invariants PASSED
tests/clustering/test_clusterer.py::test_centroid_invariants PASSED
tests/clustering/test_clusterer.py::test_cluster_result_types PASSED
tests/clustering/test_clusterer.py::test_cluster_info_types PASSED
tests/clustering/test_experience.py::test_cluster_axis_success 2025-12-07 18:50:43 [info     ] clustering.complete            axis=full n_clusters=2 noise_count=10 total_points=20
PASSED
tests/clustering/test_experience.py::test_cluster_axis_invalid PASSED
tests/clustering/test_experience.py::test_cluster_axis_no_data PASSED
tests/clustering/test_experience.py::test_cluster_axis_with_weights 2025-12-07 18:50:43 [info     ] clustering.complete            axis=strategy n_clusters=2 noise_count=10 total_points=20
PASSED
tests/clustering/test_experience.py::test_cluster_axis_missing_tier 2025-12-07 18:50:43 [info     ] clustering.complete            axis=full n_clusters=2 noise_count=10 total_points=20
PASSED
tests/clustering/test_experience.py::test_cluster_axis_all_noise 2025-12-07 18:50:43 [warning  ] clustering.all_noise           axis=full message='HDBSCAN labeled all points as noise - no clusters found' noise_count=5 total_points=5
PASSED
tests/clustering/test_experience.py::test_cluster_all_axes 2025-12-07 18:50:43 [warning  ] clustering.all_noise           axis=full message='HDBSCAN labeled all points as noise - no clusters found' noise_count=10 total_points=10
2025-12-07 18:50:43 [warning  ] clustering.all_noise           axis=strategy message='HDBSCAN labeled all points as noise - no clusters found' noise_count=15 total_points=15
2025-12-07 18:50:43 [warning  ] clustering.axis_skipped        axis=surprise error="No embeddings found for axis 'surprise' (collection: ghap_surprise)" message='Skipping axis due to error'
2025-12-07 18:50:43 [warning  ] clustering.axis_skipped        axis=root_cause error="No embeddings found for axis 'root_cause' (collection: ghap_root_cause)" message='Skipping axis due to error'
PASSED
tests/clustering/test_experience.py::test_cluster_all_axes_all_empty 2025-12-07 18:50:43 [warning  ] clustering.axis_skipped        axis=full error="No embeddings found for axis 'full' (collection: ghap_full)" message='Skipping axis due to error'
2025-12-07 18:50:43 [warning  ] clustering.axis_skipped        axis=strategy error="No embeddings found for axis 'strategy' (collection: ghap_strategy)" message='Skipping axis due to error'
2025-12-07 18:50:43 [warning  ] clustering.axis_skipped        axis=surprise error="No embeddings found for axis 'surprise' (collection: ghap_surprise)" message='Skipping axis due to error'
2025-12-07 18:50:43 [warning  ] clustering.axis_skipped        axis=root_cause error="No embeddings found for axis 'root_cause' (collection: ghap_root_cause)" message='Skipping axis due to error'
PASSED
tests/clustering/test_experience.py::test_cluster_axis_calls_correct_collection 2025-12-07 18:50:43 [info     ] clustering.complete            axis=full n_clusters=2 noise_count=10 total_points=20
2025-12-07 18:50:43 [info     ] clustering.complete            axis=strategy n_clusters=2 noise_count=10 total_points=20
2025-12-07 18:50:43 [info     ] clustering.complete            axis=surprise n_clusters=2 noise_count=10 total_points=20
2025-12-07 18:50:43 [info     ] clustering.complete            axis=root_cause n_clusters=2 noise_count=10 total_points=20
PASSED
tests/clustering/test_experience.py::test_cluster_axis_scroll_limit_warning 2025-12-07 18:50:43 [warning  ] clustering.scroll_limit_reached axis=full collection=ghap_full count=10000 message='May have truncated results - consider pagination'
2025-12-07 18:50:52 [info     ] clustering.complete            axis=full n_clusters=358 noise_count=8166 total_points=10000
PASSED
tests/clustering/test_types.py::test_confidence_weights_mapping PASSED
tests/clustering/test_types.py::test_get_weight_valid_tiers PASSED
tests/clustering/test_types.py::test_get_weight_case_insensitive PASSED
tests/clustering/test_types.py::test_get_weight_none PASSED
tests/clustering/test_types.py::test_get_weight_invalid PASSED
tests/context/test_assembler.py::test_assemble_single_source_memories 2025-12-07 18:50:52 [info     ] assembling_context             component=context_assembler context_types=['memories'] limit=20 max_tokens=1000 query='coding preferences'
2025-12-07 18:50:52 [info     ] deduplication_complete         component=context_assembler deduplicated_count=1 original_count=1
2025-12-07 18:50:52 [debug    ] source_budget_used             budget=1000 component=context_assembler items_selected=1 source=memories unused=983 used=17
2025-12-07 18:50:52 [debug    ] redistributing_unused_budget   component=context_assembler total_unused=983
PASSED
tests/context/test_assembler.py::test_assemble_multiple_sources 2025-12-07 18:50:52 [info     ] assembling_context             component=context_assembler context_types=['memories', 'code'] limit=20 max_tokens=2000 query='python examples'
2025-12-07 18:50:52 [info     ] deduplication_complete         component=context_assembler deduplicated_count=2 original_count=2
2025-12-07 18:50:52 [debug    ] source_budget_used             budget=666 component=context_assembler items_selected=1 source=memories unused=649 used=17
2025-12-07 18:50:52 [debug    ] source_budget_used             budget=1333 component=context_assembler items_selected=1 source=code unused=1308 used=25
2025-12-07 18:50:52 [debug    ] redistributing_unused_budget   component=context_assembler total_unused=1957
PASSED
tests/context/test_assembler.py::test_invalid_context_type PASSED
tests/context/test_assembler.py::test_empty_results 2025-12-07 18:50:52 [info     ] assembling_context             component=context_assembler context_types=['memories', 'code'] limit=20 max_tokens=1000 query=nothing
2025-12-07 18:50:52 [info     ] deduplication_complete         component=context_assembler deduplicated_count=0 original_count=0
PASSED
tests/context/test_assembler.py::test_token_budget_distribution 2025-12-07 18:50:52 [info     ] assembling_context             component=context_assembler context_types=['memories'] limit=20 max_tokens=500 query=test
2025-12-07 18:50:52 [info     ] deduplication_complete         component=context_assembler deduplicated_count=8 original_count=8
2025-12-07 18:50:52 [debug    ] source_budget_used             budget=500 component=context_assembler items_selected=8 source=memories unused=354 used=146
2025-12-07 18:50:52 [debug    ] redistributing_unused_budget   component=context_assembler total_unused=354
PASSED
tests/context/test_assembler.py::test_deduplication 2025-12-07 18:50:52 [info     ] assembling_context             component=context_assembler context_types=['experiences', 'values'] limit=20 max_tokens=2000 query=test
2025-12-07 18:50:52 [info     ] deduplication_complete         component=context_assembler deduplicated_count=1 original_count=2
2025-12-07 18:50:52 [debug    ] source_budget_used             budget=500 component=context_assembler items_selected=1 source=values unused=487 used=13
2025-12-07 18:50:52 [debug    ] redistributing_unused_budget   component=context_assembler total_unused=487
PASSED
tests/context/test_assembler.py::test_premortem_context 2025-12-07 18:50:52 [info     ] assembling_premortem           component=context_assembler domain=debugging limit=10 strategy=systematic
PASSED
tests/context/test_assembler.py::test_premortem_partial_failure 2025-12-07 18:50:52 [info     ] assembling_premortem           component=context_assembler domain=debugging limit=10 strategy=None
2025-12-07 18:50:52 [warning  ] premortem_query_partial_failure component=context_assembler error='Surprise axis failed' query_index=1
PASSED
tests/context/test_assembler.py::test_partial_source_failure 2025-12-07 18:50:52 [info     ] assembling_context             component=context_assembler context_types=['memories', 'code'] limit=20 max_tokens=2000 query=test
2025-12-07 18:50:52 [warning  ] source_query_partial_failure   component=context_assembler error='Code search failed' source=code
2025-12-07 18:50:52 [info     ] deduplication_complete         component=context_assembler deduplicated_count=1 original_count=1
2025-12-07 18:50:52 [debug    ] source_budget_used             budget=666 component=context_assembler items_selected=1 source=memories unused=652 used=14
2025-12-07 18:50:52 [debug    ] redistributing_unused_budget   component=context_assembler total_unused=652
PASSED
tests/context/test_deduplication.py::test_deduplicate_items_empty PASSED
tests/context/test_deduplication.py::test_deduplicate_items_no_duplicates PASSED
tests/context/test_deduplication.py::test_deduplicate_items_by_ghap_id PASSED
tests/context/test_deduplication.py::test_deduplicate_items_by_file_path PASSED
tests/context/test_deduplication.py::test_deduplicate_items_by_sha PASSED
tests/context/test_deduplication.py::test_deduplicate_items_by_memory_id PASSED
tests/context/test_deduplication.py::test_deduplicate_items_fuzzy_match PASSED
tests/context/test_deduplication.py::test_deduplicate_items_fuzzy_no_match PASSED
tests/context/test_deduplication.py::test_deduplicate_items_sorted_by_relevance PASSED
tests/context/test_deduplication.py::test_deduplicate_items_skips_long_content PASSED
tests/context/test_formatting.py::test_format_memory PASSED
tests/context/test_formatting.py::test_format_code PASSED
tests/context/test_formatting.py::test_format_code_no_docstring PASSED
tests/context/test_formatting.py::test_format_experience PASSED
tests/context/test_formatting.py::test_format_experience_no_optional_fields PASSED
tests/context/test_formatting.py::test_format_value PASSED
tests/context/test_formatting.py::test_format_commit PASSED
tests/context/test_formatting.py::test_format_commit_many_files PASSED
tests/context/test_formatting.py::test_assemble_markdown_standard PASSED
tests/context/test_formatting.py::test_assemble_markdown_empty_sources PASSED
tests/context/test_formatting.py::test_assemble_markdown_premortem PASSED
tests/context/test_formatting.py::test_assemble_markdown_premortem_no_strategy PASSED
tests/context/test_tokens.py::test_estimate_tokens_basic PASSED
tests/context/test_tokens.py::test_estimate_tokens_empty PASSED
tests/context/test_tokens.py::test_truncate_to_tokens_no_truncation PASSED
tests/context/test_tokens.py::test_truncate_to_tokens_truncates PASSED
tests/context/test_tokens.py::test_truncate_to_tokens_prefers_newline PASSED
tests/context/test_tokens.py::test_distribute_budget_single_source PASSED
tests/context/test_tokens.py::test_distribute_budget_multiple_sources PASSED
tests/context/test_tokens.py::test_distribute_budget_all_sources PASSED
tests/context/test_tokens.py::test_cap_item_tokens_no_cap PASSED
tests/context/test_tokens.py::test_cap_item_tokens_applies_cap PASSED
tests/context/test_tokens.py::test_cap_item_tokens_code_note PASSED
tests/context/test_tokens.py::test_cap_item_tokens_experience_note PASSED
tests/embedding/test_bug_014_mps_workaround.py::test_bug_014_embedding_model_uses_cpu_on_mps PASSED
tests/embedding/test_bug_014_mps_workaround.py::test_bug_014_large_indexing_completes 2025-12-07 18:51:01 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:51:01 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/__init__.py project=test_project
2025-12-07 18:51:01 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/indexers/tree_sitter.py project=test_project
2025-12-07 18:51:13 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/indexers/__init__.py project=test_project
2025-12-07 18:51:13 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/indexers/utils.py project=test_project
2025-12-07 18:51:14 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/indexers/indexer.py project=test_project
2025-12-07 18:51:18 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/indexers/base.py project=test_project
2025-12-07 18:51:19 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/context/models.py project=test_project
2025-12-07 18:51:19 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/context/searcher_types.py project=test_project
2025-12-07 18:51:19 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/context/deduplication.py project=test_project
2025-12-07 18:51:20 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/context/__init__.py project=test_project
2025-12-07 18:51:20 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/context/tokens.py project=test_project
2025-12-07 18:51:20 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/context/assembler.py project=test_project
2025-12-07 18:51:23 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/context/formatting.py project=test_project
2025-12-07 18:51:25 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/embedding/nomic.py project=test_project
2025-12-07 18:51:26 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/embedding/registry.py project=test_project
2025-12-07 18:51:28 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/embedding/__init__.py project=test_project
2025-12-07 18:51:28 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/embedding/minilm.py project=test_project
2025-12-07 18:51:29 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/embedding/base.py project=test_project
2025-12-07 18:51:29 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/embedding/mock.py project=test_project
2025-12-07 18:51:30 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/clustering/experience.py project=test_project
2025-12-07 18:51:31 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/clustering/__init__.py project=test_project
2025-12-07 18:51:31 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/clustering/types.py project=test_project
2025-12-07 18:51:32 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/clustering/clusterer.py project=test_project
2025-12-07 18:51:33 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/values/store.py project=test_project
2025-12-07 18:51:36 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/values/__init__.py project=test_project
2025-12-07 18:51:36 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/values/types.py project=test_project
2025-12-07 18:51:36 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/server/logging.py project=test_project
2025-12-07 18:51:36 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/server/config.py project=test_project
2025-12-07 18:51:36 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/server/__init__.py project=test_project
2025-12-07 18:51:36 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/server/errors.py project=test_project
2025-12-07 18:51:36 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/server/main.py project=test_project
2025-12-07 18:51:37 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/storage/metadata.py project=test_project
2025-12-07 18:51:43 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/storage/memory.py project=test_project
2025-12-07 18:51:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/storage/qdrant.py project=test_project
2025-12-07 18:51:50 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/storage/__init__.py project=test_project
2025-12-07 18:51:50 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/storage/base.py project=test_project
2025-12-07 18:51:51 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/storage/schema.py project=test_project
2025-12-07 18:51:51 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/search/results.py project=test_project
2025-12-07 18:51:51 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/search/searcher.py project=test_project
2025-12-07 18:51:54 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/search/__init__.py project=test_project
2025-12-07 18:51:54 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/search/collections.py project=test_project
2025-12-07 18:51:54 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/verification/__init__.py project=test_project
2025-12-07 18:51:54 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/git/analyzer.py project=test_project
2025-12-07 18:51:58 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/git/__init__.py project=test_project
2025-12-07 18:51:58 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/git/reader.py project=test_project
2025-12-07 18:52:01 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/git/base.py project=test_project
2025-12-07 18:52:02 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/observation/persister.py project=test_project
2025-12-07 18:52:05 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/observation/models.py project=test_project
2025-12-07 18:52:05 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/observation/collector.py project=test_project
2025-12-07 18:52:12 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/src/learning_memory_server/observation/__init__.py project=test_project
PASSED
tests/embedding/test_bug_014_mps_workaround.py::test_bug_014_batch_encoding_performance PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_dimension PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_returns_correct_shape PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_deterministic PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_different_texts_produce_different_embeddings PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_normalized PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_batch_empty_list PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_batch_single_item PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_batch_multiple_items PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_batch_consistency_with_embed PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_handles_special_characters PASSED
tests/embedding/test_mock.py::TestMockEmbedding::test_embed_long_text PASSED
tests/gates/test_check_types.py::test_check_types_completes_standalone PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_initial 2025-12-07 18:52:20 [info     ] full_index_starting            force=False has_state=False repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpgbqdeqyc
PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_incremental 2025-12-07 18:52:20 [info     ] full_index_starting            force=False has_state=False repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmp7o6i66u7
2025-12-07 18:52:21 [info     ] incremental_index_starting     new_commits=1 repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmp7o6i66u7
PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_already_up_to_date 2025-12-07 18:52:21 [info     ] full_index_starting            force=False has_state=False repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmp65cm0t7z
2025-12-07 18:52:21 [info     ] index_already_up_to_date       repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmp65cm0t7z
PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_force_reindex 2025-12-07 18:52:21 [info     ] full_index_starting            force=False has_state=False repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpabtdfd62
2025-12-07 18:52:21 [info     ] full_index_starting            force=True has_state=True repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpabtdfd62
PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_with_limit 2025-12-07 18:52:22 [info     ] full_index_starting            force=False has_state=False repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmp98jrmy9j
PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_commits_five_year_limit 2025-12-07 18:52:22 [info     ] full_index_starting            force=False has_state=False repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpske2f8c0
PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_search_commits 2025-12-07 18:52:22 [info     ] full_index_starting            force=False has_state=False repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpgxfa335m
PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_search_commits_with_author_filter 2025-12-07 18:52:23 [info     ] full_index_starting            force=False has_state=False repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmp23sh150t
PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_search_commits_with_date_filter 2025-12-07 18:52:23 [info     ] full_index_starting            force=False has_state=False repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpwg5w7166
PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_get_churn_hotspots PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_get_file_authors PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_get_change_frequency PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_get_change_frequency_nonexistent_file PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_blame_search PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_blame_search_with_file_pattern PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_embedding_text_format PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_embedding_text_truncation PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_index_state_tracking 2025-12-07 18:52:25 [info     ] full_index_starting            force=False has_state=False repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpufbywtyn
PASSED
tests/git/test_analyzer.py::TestGitAnalyzer::test_batch_embedding_performance 2025-12-07 18:52:25 [info     ] full_index_starting            force=False has_state=False repo_path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpa2i8s0uj
PASSED
tests/git/test_analyzer.py::test_integration_with_real_repo 2025-12-07 18:52:26 [info     ] full_index_starting            force=False has_state=False repo_path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006
PASSED
tests/git/test_reader.py::TestGitPythonReader::test_init_with_valid_repo PASSED
tests/git/test_reader.py::TestGitPythonReader::test_init_with_invalid_repo PASSED
tests/git/test_reader.py::TestGitPythonReader::test_init_with_nonexistent_path PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_empty_repo PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_single_commit PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_multiple_commits PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_with_limit PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_with_path_filter PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_commits_with_date_filter PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_blame_text_file PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_blame_nonexistent_file PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_blame_binary_file PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_file_history PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_head_sha PASSED
tests/git/test_reader.py::TestGitPythonReader::test_get_head_sha_empty_repo PASSED
tests/git/test_reader.py::TestGitPythonReader::test_commit_timezone_aware PASSED
tests/git/test_reader.py::TestGitPythonReader::test_blame_timezone_aware PASSED
tests/git/test_reader.py::TestGitPythonReader::test_files_changed_relative_paths PASSED
tests/git/test_reader.py::test_integration_with_real_repo PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_init PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_connect_success PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_connect_timeout 2025-12-07 18:52:46 [warning  ] mcp_client.connect_failed      error='TestMCPClient.test_connect_timeout.<locals>.slow_connect() takes 0 positional arguments but 1 was given'
PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_connect_exception 2025-12-07 18:52:46 [warning  ] mcp_client.connect_failed      error='Connection failed'
PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_not_connected 2025-12-07 18:52:46 [warning  ] mcp_client.not_connected
PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_success PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_empty_content PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_invalid_json 2025-12-07 18:52:46 [error    ] mcp_client.invalid_json        error='Expecting value: line 1 column 1 (char 0)' tool=test_tool
PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_timeout 2025-12-07 18:52:46 [warning  ] mcp_client.call_failed         error= tool=slow_tool
PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_call_tool_exception 2025-12-07 18:52:46 [warning  ] mcp_client.call_failed         error='Tool call failed' tool=test_tool
PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_close_with_session PASSED
tests/hooks/test_mcp_client.py::TestMCPClient::test_close_without_session PASSED
tests/hooks/test_mcp_client.py::TestMainCLI::test_main_invalid_args PASSED
tests/hooks/test_mcp_client.py::TestMainCLI::test_main_invalid_json_args PASSED
tests/hooks/test_mcp_client.py::TestMainCLI::test_main_connection_failed PASSED
tests/hooks/test_mcp_client.py::TestMainCLI::test_main_success PASSED
tests/indexers/test_bug_003_regression.py::test_bug_003_double_index_inmemory 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/pytest-of-elliotmilco/pytest-121/test_bug_003_double_index_inme0/test.py project=test_project
2025-12-07 18:52:46 [info     ] file_skipped                   path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/pytest-of-elliotmilco/pytest-121/test_bug_003_double_index_inme0/test.py reason=no_changes
PASSED
tests/indexers/test_bug_003_regression.py::test_bug_003_double_index_with_modification 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/pytest-of-elliotmilco/pytest-121/test_bug_003_double_index_with0/modified.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=1 path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/pytest-of-elliotmilco/pytest-121/test_bug_003_double_index_with0/modified.py project=test_project
PASSED
tests/indexers/test_bug_003_regression.py::test_bug_003_multiple_projects_same_collection 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/pytest-of-elliotmilco/pytest-121/test_bug_003_multiple_projects0/project1/main.py project=project1
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/pytest-of-elliotmilco/pytest-121/test_bug_003_multiple_projects0/project2/main.py project=project2
2025-12-07 18:52:46 [info     ] file_skipped                   path=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/pytest-of-elliotmilco/pytest-121/test_bug_003_multiple_projects0/project1/main.py reason=no_changes
PASSED
tests/indexers/test_bug_012_exclusions.py::test_bug_012_default_exclusions_prevent_venv_indexing 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpm6z3n6pc/src/utils.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpm6z3n6pc/src/main.py project=test_project
PASSED
tests/indexers/test_bug_012_exclusions.py::test_bug_012_indexing_completes_in_reasonable_time 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpau4w_klp/src/module_2.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpau4w_klp/src/module_6.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpau4w_klp/src/module_7.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpau4w_klp/src/module_3.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpau4w_klp/src/module_8.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpau4w_klp/src/module_9.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpau4w_klp/src/module_4.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpau4w_klp/src/module_0.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpau4w_klp/src/module_1.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpau4w_klp/src/module_5.py project=test_project
PASSED
tests/indexers/test_indexer.py::test_index_single_file 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.py project=test_project
PASSED
tests/indexers/test_indexer.py::test_index_file_twice_skips_second 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.py project=test_project
2025-12-07 18:52:46 [info     ] file_skipped                   path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.py reason=no_changes
PASSED
tests/indexers/test_indexer.py::test_index_directory 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/malformed.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.swift project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.ts project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.java project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.cpp project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.c project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.rs project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.js project=test_project
PASSED
tests/indexers/test_indexer.py::test_remove_file 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=7 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.py project=test_project
2025-12-07 18:52:46 [info     ] file_removed                   path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.py project=test_project units_removed=7
PASSED
tests/indexers/test_indexer.py::test_remove_project 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.ts project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=7 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=5 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.ts project=test_project
2025-12-07 18:52:46 [info     ] project_removed                files_count=2 project=test_project
PASSED
tests/indexers/test_indexer.py::test_reindex_prevents_orphans 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpcllc21u_.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=3 path=/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/tmpcllc21u_.py project=test_project
PASSED
tests/indexers/test_indexer.py::test_empty_file_handling 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
PASSED
tests/indexers/test_indexer.py::test_error_accumulation 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/malformed.py project=test_project
PASSED
tests/indexers/test_indexer.py::test_exclude_patterns 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.swift project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.ts project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.java project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.cpp project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.c project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.py project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.rs project=test_project
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.js project=test_project
PASSED
tests/indexers/test_indexer.py::test_get_indexing_stats 2025-12-07 18:52:46 [info     ] collection_created             dimension=768 name=code_units
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.py project=project1
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.ts project=project1
2025-12-07 18:52:46 [debug    ] file_units_deleted             count=0 path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/tests/fixtures/code_samples/sample.js project=project2
PASSED
tests/indexers/test_tree_sitter.py::test_language_detection PASSED
tests/indexers/test_tree_sitter.py::test_supported_languages PASSED
tests/indexers/test_tree_sitter.py::test_parse_python PASSED
tests/indexers/test_tree_sitter.py::test_parse_typescript PASSED
tests/indexers/test_tree_sitter.py::test_parse_javascript PASSED
tests/indexers/test_tree_sitter.py::test_parse_rust PASSED
tests/indexers/test_tree_sitter.py::test_parse_java PASSED
tests/indexers/test_tree_sitter.py::test_parse_c PASSED
tests/indexers/test_tree_sitter.py::test_parse_cpp PASSED
tests/indexers/test_tree_sitter.py::test_parse_swift PASSED
tests/indexers/test_tree_sitter.py::test_parse_empty_file PASSED
tests/indexers/test_tree_sitter.py::test_parse_malformed_file PASSED
tests/observation/test_collector.py::test_create_ghap 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_2cf3ca
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_702cff
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_702cff strategy=systematic-elimination
PASSED
tests/observation/test_collector.py::test_create_ghap_auto_starts_session 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_907bf7
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_138c40
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_138c40 strategy=systematic-elimination
PASSED
tests/observation/test_collector.py::test_create_ghap_when_active_raises 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_6e89ab
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_a060a0
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_a060a0 strategy=systematic-elimination
2025-12-07 18:52:46 [warning  ] ghap_already_active            current_id=ghap_20251207_235246_a060a0
PASSED
tests/observation/test_collector.py::test_update_ghap_changes_hypothesis 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_2f68a2
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_a980d4
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_a980d4 strategy=systematic-elimination
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_a980d4
2025-12-07 18:52:46 [info     ] ghap_updated                   ghap_id=ghap_20251207_235246_a980d4 hap_changed=True iteration=2
PASSED
tests/observation/test_collector.py::test_update_ghap_changes_all_hap 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_cd31be
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_ed305f
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_ed305f strategy=systematic-elimination
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_ed305f
2025-12-07 18:52:46 [info     ] ghap_updated                   ghap_id=ghap_20251207_235246_ed305f hap_changed=True iteration=2
PASSED
tests/observation/test_collector.py::test_update_ghap_note_only 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_bc95f0
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_d338ae
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_d338ae strategy=systematic-elimination
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_d338ae
2025-12-07 18:52:46 [info     ] ghap_updated                   ghap_id=ghap_20251207_235246_d338ae hap_changed=False iteration=1
PASSED
tests/observation/test_collector.py::test_update_ghap_strategy_only 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_01211a
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_3e1779
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_3e1779 strategy=systematic-elimination
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_3e1779
2025-12-07 18:52:46 [info     ] ghap_updated                   ghap_id=ghap_20251207_235246_3e1779 hap_changed=False iteration=1
PASSED
tests/observation/test_collector.py::test_update_ghap_no_active_raises 2025-12-07 18:52:46 [warning  ] no_active_ghap_for_update
PASSED
tests/observation/test_collector.py::test_resolve_ghap_confirmed 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_f1f389
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_d8a058
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_d8a058 strategy=systematic-elimination
2025-12-07 18:52:46 [info     ] ghap_resolved                  ghap_id=ghap_20251207_235246_d8a058 iterations=1 status=confirmed tier=silver
PASSED
tests/observation/test_collector.py::test_resolve_ghap_auto_captured_gold 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_58ee8b
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_cc8d56
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_cc8d56 strategy=systematic-elimination
2025-12-07 18:52:46 [info     ] ghap_resolved                  ghap_id=ghap_20251207_235246_cc8d56 iterations=1 status=confirmed tier=gold
PASSED
tests/observation/test_collector.py::test_abandon_ghap 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_c834cf
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_3850d4
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_3850d4 strategy=systematic-elimination
2025-12-07 18:52:46 [info     ] ghap_resolved                  ghap_id=ghap_20251207_235246_3850d4 iterations=1 status=abandoned tier=abandoned
PASSED
tests/observation/test_collector.py::test_start_session 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_9274c1
PASSED
tests/observation/test_collector.py::test_start_session_archives_previous 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_4a2ae1
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_c9ea2a
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_c9ea2a strategy=systematic-elimination
2025-12-07 18:52:46 [info     ] ghap_resolved                  ghap_id=ghap_20251207_235246_c9ea2a iterations=1 status=confirmed tier=silver
2025-12-07 18:52:46 [info     ] session_archived               archive_file=20251207_session_20251207_235246_4a2ae1.jsonl entry_count=1 session_id=session_20251207_235246_4a2ae1
2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_88d265
PASSED
tests/observation/test_collector.py::test_end_session 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_17d199
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_6a5a1d
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_6a5a1d strategy=systematic-elimination
2025-12-07 18:52:46 [info     ] ghap_resolved                  ghap_id=ghap_20251207_235246_6a5a1d iterations=1 status=confirmed tier=silver
2025-12-07 18:52:46 [info     ] session_archived               archive_file=20251207_session_20251207_235246_17d199.jsonl entry_count=1 session_id=session_20251207_235246_17d199
2025-12-07 18:52:46 [info     ] session_ended                  entries_archived=1 session_id=session_20251207_235246_17d199
PASSED
tests/observation/test_collector.py::test_end_session_abandons_current 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_3360d9
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_08ba3f
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_08ba3f strategy=systematic-elimination
2025-12-07 18:52:46 [info     ] ghap_resolved                  ghap_id=ghap_20251207_235246_08ba3f iterations=1 status=abandoned tier=abandoned
2025-12-07 18:52:46 [info     ] session_archived               archive_file=20251207_session_20251207_235246_3360d9.jsonl entry_count=1 session_id=session_20251207_235246_3360d9
2025-12-07 18:52:46 [info     ] session_ended                  entries_archived=1 session_id=session_20251207_235246_3360d9
PASSED
tests/observation/test_collector.py::test_has_orphaned_entry 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_de7fa8
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_9ae049
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_9ae049 strategy=systematic-elimination
2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_ccc41d
PASSED
tests/observation/test_collector.py::test_adopt_orphan 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_58b24b
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_fec130
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_fec130 strategy=systematic-elimination
2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_a16f38
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_fec130
2025-12-07 18:52:46 [info     ] orphan_adopted                 ghap_id=ghap_20251207_235246_fec130 new_session_id=session_20251207_235246_a16f38
PASSED
tests/observation/test_collector.py::test_abandon_orphan 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_04f9af
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_d293cc
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_d293cc strategy=systematic-elimination
2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_92cc77
2025-12-07 18:52:46 [info     ] entry_archived_to_session      archive_file=20251207_session_20251207_235246_04f9af.jsonl ghap_id=ghap_20251207_235246_d293cc session_id=session_20251207_235246_04f9af
2025-12-07 18:52:46 [info     ] orphan_abandoned               ghap_id=ghap_20251207_235246_d293cc original_session_id=session_20251207_235246_04f9af
PASSED
tests/observation/test_collector.py::test_increment_tool_count PASSED
tests/observation/test_collector.py::test_should_check_in 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_833393
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_6e4635
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_6e4635 strategy=systematic-elimination
PASSED
tests/observation/test_collector.py::test_reset_tool_count PASSED
tests/observation/test_collector.py::test_tool_count_persists PASSED
tests/observation/test_collector.py::test_full_session_lifecycle 2025-12-07 18:52:46 [info     ] session_started                session_id=session_20251207_235246_bcc09e
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_a93f92
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_a93f92 strategy=systematic-elimination
2025-12-07 18:52:46 [info     ] ghap_resolved                  ghap_id=ghap_20251207_235246_a93f92 iterations=1 status=confirmed tier=silver
2025-12-07 18:52:46 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235246_dad83f
2025-12-07 18:52:46 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235246_dad83f strategy=systematic-elimination
2025-12-07 18:52:46 [info     ] ghap_resolved                  ghap_id=ghap_20251207_235246_dad83f iterations=1 status=confirmed tier=silver
2025-12-07 18:52:47 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235247_c881e7
2025-12-07 18:52:47 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235247_c881e7 strategy=systematic-elimination
2025-12-07 18:52:47 [info     ] ghap_resolved                  ghap_id=ghap_20251207_235247_c881e7 iterations=1 status=confirmed tier=silver
2025-12-07 18:52:47 [info     ] session_archived               archive_file=20251207_session_20251207_235246_bcc09e.jsonl entry_count=3 session_id=session_20251207_235246_bcc09e
2025-12-07 18:52:47 [info     ] session_ended                  entries_archived=3 session_id=session_20251207_235246_bcc09e
PASSED
tests/observation/test_collector.py::test_state_survives_restart 2025-12-07 18:52:47 [info     ] session_started                session_id=session_20251207_235247_9878f0
2025-12-07 18:52:47 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235247_7fba20
2025-12-07 18:52:47 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235247_7fba20 strategy=systematic-elimination
PASSED
tests/observation/test_collector.py::test_multiple_iterations 2025-12-07 18:52:47 [info     ] session_started                session_id=session_20251207_235247_eedccb
2025-12-07 18:52:47 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235247_8dbd52
2025-12-07 18:52:47 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235247_8dbd52 strategy=systematic-elimination
2025-12-07 18:52:47 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235247_8dbd52
2025-12-07 18:52:47 [info     ] ghap_updated                   ghap_id=ghap_20251207_235247_8dbd52 hap_changed=True iteration=2
2025-12-07 18:52:47 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235247_8dbd52
2025-12-07 18:52:47 [info     ] ghap_updated                   ghap_id=ghap_20251207_235247_8dbd52 hap_changed=True iteration=3
PASSED
tests/observation/test_collector.py::test_text_truncation 2025-12-07 18:52:47 [info     ] session_started                session_id=session_20251207_235247_8d3e3c
2025-12-07 18:52:47 [warning  ] text_truncated                 max_len=10000 original_len=15000
2025-12-07 18:52:47 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235247_d00fd3
2025-12-07 18:52:47 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235247_d00fd3 strategy=systematic-elimination
PASSED
tests/observation/test_collector.py::test_corrupted_current_ghap_recovery 2025-12-07 18:52:47 [info     ] session_started                session_id=session_20251207_235247_3aaf4b
2025-12-07 18:52:47 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235247_4f7b8f
2025-12-07 18:52:47 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235247_4f7b8f strategy=systematic-elimination
2025-12-07 18:52:47 [error    ] corrupted_ghap_backed_up       backup=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/pytest-of-elliotmilco/pytest-121/test_corrupted_current_ghap_re0/journal/current_ghap.corrupted.1765151567 error='Expecting value: line 1 column 1 (char 0)' file=/private/var/folders/kw/rp67pf8d5ng588lqp7d_gb240000gn/T/pytest-of-elliotmilco/pytest-121/test_corrupted_current_ghap_re0/journal/current_ghap.json
PASSED
tests/observation/test_collector.py::test_corrupted_session_entries_recovery 2025-12-07 18:52:47 [info     ] session_started                session_id=session_20251207_235247_5dcfbc
2025-12-07 18:52:47 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235247_8d27e4
2025-12-07 18:52:47 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235247_8d27e4 strategy=systematic-elimination
2025-12-07 18:52:47 [info     ] ghap_resolved                  ghap_id=ghap_20251207_235247_8d27e4 iterations=1 status=confirmed tier=silver
2025-12-07 18:52:47 [debug    ] ghap_saved                     ghap_id=ghap_20251207_235247_26e53d
2025-12-07 18:52:47 [info     ] ghap_created                   domain=debugging ghap_id=ghap_20251207_235247_26e53d strategy=systematic-elimination
2025-12-07 18:52:47 [info     ] ghap_resolved                  ghap_id=ghap_20251207_235247_26e53d iterations=1 status=confirmed tier=silver
2025-12-07 18:52:47 [warning  ] corrupt_entry_skipped          error='Expecting value: line 1 column 1 (char 0)' line_num=2
PASSED
tests/observation/test_models.py::test_root_cause_serialization PASSED
tests/observation/test_models.py::test_lesson_serialization PASSED
tests/observation/test_models.py::test_lesson_optional_takeaway PASSED
tests/observation/test_models.py::test_history_entry_serialization PASSED
tests/observation/test_models.py::test_outcome_serialization PASSED
tests/observation/test_models.py::test_ghap_entry_minimal_serialization PASSED
tests/observation/test_models.py::test_ghap_entry_full_serialization PASSED
tests/observation/test_models.py::test_domain_enum_values PASSED
tests/observation/test_models.py::test_strategy_enum_values PASSED
tests/observation/test_models.py::test_outcome_status_enum_values PASSED
tests/observation/test_models.py::test_confidence_tier_enum_values PASSED
tests/observation/test_persister.py::test_render_full_axis_with_all_fields PASSED
tests/observation/test_persister.py::test_render_full_axis_without_optional_fields PASSED
tests/observation/test_persister.py::test_render_strategy_axis PASSED
tests/observation/test_persister.py::test_render_surprise_axis PASSED
tests/observation/test_persister.py::test_render_root_cause_axis PASSED
tests/observation/test_persister.py::test_build_metadata_structure PASSED
tests/observation/test_persister.py::test_metadata_timestamp_conversion PASSED
tests/observation/test_persister.py::test_axis_specific_metadata PASSED
tests/observation/test_persister.py::test_confirmed_entry_gets_full_and_strategy_only PASSED
tests/observation/test_persister.py::test_falsified_entry_with_surprise_gets_all_axes PASSED
tests/observation/test_persister.py::test_falsified_without_surprise_skips_surprise_axis PASSED
tests/observation/test_persister.py::test_render_with_empty_string_vs_none PASSED
tests/observation/test_persister.py::test_entry_with_no_confidence_tier PASSED
tests/observation/test_persister.py::test_unicode_emoji_in_fields PASSED
tests/observation/test_persister.py::test_very_long_field_values PASSED
tests/observation/test_persister.py::test_special_regex_chars_in_field_values PASSED
tests/observation/test_persister.py::test_all_confidence_tier_values PASSED
tests/observation/test_persister.py::test_literal_template_syntax_in_fields PASSED
tests/observation/test_persister.py::test_root_cause_without_surprise 2025-12-07 18:52:47 [warning  ] root_cause_without_surprise    ghap_id=ghap_test note='Skipping root_cause axis (requires surprise text)'
PASSED
tests/observation/test_persister.py::test_persist_confirmed_entry 2025-12-07 18:52:47 [info     ] axis_persisted                 axis=full collection=ghap_full ghap_id=ghap_20251204_120000_abc123
2025-12-07 18:52:47 [info     ] axis_persisted                 axis=strategy collection=ghap_strategy ghap_id=ghap_20251204_120000_abc123
PASSED
tests/observation/test_persister.py::test_persist_falsified_entry_with_surprise 2025-12-07 18:52:47 [info     ] axis_persisted                 axis=full collection=ghap_full ghap_id=ghap_20251204_130000_def456
2025-12-07 18:52:47 [info     ] axis_persisted                 axis=strategy collection=ghap_strategy ghap_id=ghap_20251204_130000_def456
2025-12-07 18:52:47 [info     ] axis_persisted                 axis=surprise collection=ghap_surprise ghap_id=ghap_20251204_130000_def456
2025-12-07 18:52:47 [info     ] axis_persisted                 axis=root_cause collection=ghap_root_cause ghap_id=ghap_20251204_130000_def456
PASSED
tests/observation/test_persister.py::test_persist_batch 2025-12-07 18:52:47 [info     ] axis_persisted                 axis=full collection=ghap_full ghap_id=ghap_20251204_120000_abc123
2025-12-07 18:52:47 [info     ] axis_persisted                 axis=strategy collection=ghap_strategy ghap_id=ghap_20251204_120000_abc123
2025-12-07 18:52:47 [info     ] axis_persisted                 axis=full collection=ghap_full ghap_id=ghap_20251204_130000_def456
2025-12-07 18:52:47 [info     ] axis_persisted                 axis=strategy collection=ghap_strategy ghap_id=ghap_20251204_130000_def456
2025-12-07 18:52:47 [info     ] axis_persisted                 axis=surprise collection=ghap_surprise ghap_id=ghap_20251204_130000_def456
2025-12-07 18:52:47 [info     ] axis_persisted                 axis=root_cause collection=ghap_root_cause ghap_id=ghap_20251204_130000_def456
2025-12-07 18:52:47 [info     ] batch_persisted                count=2
PASSED
tests/observation/test_persister.py::test_persist_without_outcome_raises PASSED
tests/observation/test_persister.py::test_ensure_collections_creates_all 2025-12-07 18:52:47 [info     ] collection_created             collection=ghap_full dimension=768
2025-12-07 18:52:47 [info     ] collection_created             collection=ghap_strategy dimension=768
2025-12-07 18:52:47 [info     ] collection_created             collection=ghap_surprise dimension=768
2025-12-07 18:52:47 [info     ] collection_created             collection=ghap_root_cause dimension=768
PASSED
tests/observation/test_persister.py::test_ensure_collections_idempotent 2025-12-07 18:52:47 [info     ] collection_created             collection=ghap_full dimension=768
2025-12-07 18:52:47 [info     ] collection_created             collection=ghap_strategy dimension=768
2025-12-07 18:52:47 [info     ] collection_created             collection=ghap_surprise dimension=768
2025-12-07 18:52:47 [info     ] collection_created             collection=ghap_root_cause dimension=768
2025-12-07 18:52:47 [debug    ] collection_already_exists      collection=ghap_full error='Collection already exists'
2025-12-07 18:52:47 [debug    ] collection_already_exists      collection=ghap_strategy error='Collection already exists'
2025-12-07 18:52:47 [debug    ] collection_already_exists      collection=ghap_surprise error='Collection already exists'
2025-12-07 18:52:47 [debug    ] collection_already_exists      collection=ghap_root_cause error='Collection already exists'
PASSED
tests/observation/test_persister.py::test_embedding_failure_propagates PASSED
tests/observation/test_persister.py::test_storage_failure_propagates PASSED
tests/observation/test_persister.py::test_batch_fails_on_first_invalid_entry PASSED
tests/observation/test_utils.py::test_generate_ghap_id PASSED
tests/observation/test_utils.py::test_generate_ghap_id_uniqueness PASSED
tests/observation/test_utils.py::test_generate_session_id PASSED
tests/observation/test_utils.py::test_generate_session_id_uniqueness PASSED
tests/observation/test_utils.py::test_compute_confidence_tier_abandoned PASSED
tests/observation/test_utils.py::test_compute_confidence_tier_gold PASSED
tests/observation/test_utils.py::test_compute_confidence_tier_silver PASSED
tests/observation/test_utils.py::test_compute_confidence_tier_no_outcome PASSED
tests/observation/test_utils.py::test_atomic_write PASSED
tests/observation/test_utils.py::test_atomic_write_overwrites_existing PASSED
tests/observation/test_utils.py::test_atomic_write_cleans_up_temp_on_error PASSED
tests/observation/test_utils.py::test_truncate_text_short PASSED
tests/observation/test_utils.py::test_truncate_text_exact_limit PASSED
tests/observation/test_utils.py::test_truncate_text_too_long 2025-12-07 18:52:47 [warning  ] text_truncated                 max_len=100 original_len=200
PASSED
tests/observation/test_utils.py::test_truncate_text_unicode 2025-12-07 18:52:47 [warning  ] text_truncated                 max_len=50 original_len=1000
PASSED
tests/search/test_results.py::TestMemoryResult::test_from_search_result_with_all_fields PASSED
tests/search/test_results.py::TestMemoryResult::test_from_search_result_with_optional_fields_none PASSED
tests/search/test_results.py::TestCodeResult::test_from_search_result_with_all_fields PASSED
tests/search/test_results.py::TestCodeResult::test_from_search_result_without_docstring PASSED
tests/search/test_results.py::TestExperienceResult::test_from_search_result_with_all_fields PASSED
tests/search/test_results.py::TestExperienceResult::test_from_search_result_without_optional_nested_objects PASSED
tests/search/test_results.py::TestValueResult::test_from_search_result PASSED
tests/search/test_results.py::TestCommitResult::test_from_search_result PASSED
tests/search/test_searcher.py::TestSearchMemories::test_calls_embed_with_query PASSED
tests/search/test_searcher.py::TestSearchMemories::test_calls_vector_store_with_correct_collection PASSED
tests/search/test_searcher.py::TestSearchMemories::test_applies_category_filter PASSED
tests/search/test_searcher.py::TestSearchMemories::test_empty_query_returns_empty_list PASSED
tests/search/test_searcher.py::TestSearchMemories::test_invalid_search_mode_raises_error PASSED
tests/search/test_searcher.py::TestSearchMemories::test_embedding_failure_raises_embedding_error PASSED
tests/search/test_searcher.py::TestSearchMemories::test_collection_not_found_raises_error PASSED
tests/search/test_searcher.py::TestSearchMemories::test_maps_results_correctly PASSED
tests/search/test_searcher.py::TestSearchCode::test_calls_embed_with_query PASSED
tests/search/test_searcher.py::TestSearchCode::test_calls_vector_store_with_correct_collection PASSED
tests/search/test_searcher.py::TestSearchCode::test_applies_multiple_filters PASSED
tests/search/test_searcher.py::TestSearchCode::test_maps_results_correctly PASSED
tests/search/test_searcher.py::TestSearchExperiences::test_calls_embed_with_query PASSED
tests/search/test_searcher.py::TestSearchExperiences::test_selects_correct_collection_for_axis PASSED
tests/search/test_searcher.py::TestSearchExperiences::test_invalid_axis_raises_error PASSED
tests/search/test_searcher.py::TestSearchExperiences::test_applies_domain_and_outcome_filters PASSED
tests/search/test_searcher.py::TestSearchExperiences::test_maps_results_with_nested_dataclasses PASSED
tests/search/test_searcher.py::TestSearchValues::test_calls_embed_with_query PASSED
tests/search/test_searcher.py::TestSearchValues::test_calls_vector_store_with_correct_collection PASSED
tests/search/test_searcher.py::TestSearchValues::test_default_limit_is_5 PASSED
tests/search/test_searcher.py::TestSearchValues::test_maps_results_correctly PASSED
tests/search/test_searcher.py::TestSearchCommits::test_calls_embed_with_query PASSED
tests/search/test_searcher.py::TestSearchCommits::test_calls_vector_store_with_correct_collection PASSED
tests/search/test_searcher.py::TestSearchCommits::test_applies_author_and_date_filters PASSED
tests/search/test_searcher.py::TestSearchCommits::test_maps_results_correctly PASSED
tests/search/test_searcher.py::TestCollectionName::test_experience_axis_mapping PASSED
tests/search/test_searcher.py::TestCollectionName::test_invalid_axis_raises_error PASSED
tests/server/test_config.py::test_default_settings PASSED
tests/server/test_config.py::test_env_override PASSED
tests/server/test_config.py::test_settings_immutable PASSED
tests/server/test_main.py::test_registry_provides_embedder 2025-12-07 18:52:49 [info     ] semantic_embedder.loaded       dimension=768 model=nomic-ai/nomic-embed-text-v1.5
PASSED
tests/server/test_main.py::test_create_server 2025-12-07 18:52:52 [info     ] semantic_embedder.loaded       dimension=768 model=nomic-ai/nomic-embed-text-v1.5
2025-12-07 18:52:53 [info     ] code_embedder.loaded           dimension=384 model=sentence-transformers/all-MiniLM-L6-v2
2025-12-07 18:52:53 [info     ] services.initializing
2025-12-07 18:52:53 [info     ] code.initialized
2025-12-07 18:52:53 [info     ] git.repo_auto_detected         repo_path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006
2025-12-07 18:52:53 [info     ] git.initialized                repo_path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006
2025-12-07 18:52:53 [info     ] services.initialized           has_code=True has_git=True has_searcher=False
2025-12-07 18:52:53 [info     ] tools.registered               has_code=True has_git=True has_searcher=False tool_count=24
2025-12-07 18:52:53 [info     ] server.created                 server_name=learning-memory-server
2025-12-07 18:52:53 [debug    ] services.metadata_store_closed
PASSED
tests/server/test_main.py::test_server_has_ping_tool 2025-12-07 18:52:56 [info     ] semantic_embedder.loaded       dimension=768 model=nomic-ai/nomic-embed-text-v1.5
2025-12-07 18:52:57 [info     ] code_embedder.loaded           dimension=384 model=sentence-transformers/all-MiniLM-L6-v2
2025-12-07 18:52:57 [info     ] services.initializing
2025-12-07 18:52:57 [info     ] code.initialized
2025-12-07 18:52:57 [info     ] git.repo_auto_detected         repo_path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006
2025-12-07 18:52:57 [info     ] git.initialized                repo_path=/Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006
2025-12-07 18:52:57 [info     ] services.initialized           has_code=True has_git=True has_searcher=False
2025-12-07 18:52:57 [info     ] tools.registered               has_code=True has_git=True has_searcher=False tool_count=24
2025-12-07 18:52:57 [info     ] server.created                 server_name=learning-memory-server
2025-12-07 18:52:57 [debug    ] services.metadata_store_closed
PASSED
tests/server/tools/test_bug_005_clusterer_initialization.py::test_clusterer_has_correct_default_parameters PASSED
tests/server/tools/test_bug_005_clusterer_initialization.py::test_experience_clusterer_accepts_clusterer_instance PASSED
tests/server/tools/test_bug_005_clusterer_initialization.py::test_value_store_accepts_experience_clusterer_instance PASSED
tests/server/tools/test_bug_005_clusterer_initialization.py::test_initialization_matches_fix_plan PASSED
tests/server/tools/test_code.py::test_index_codebase_not_available ERROR

==================================== ERRORS ====================================
_____________ ERROR at setup of test_index_codebase_not_available ______________

self = <Coroutine test_index_codebase_not_available>

    def setup(self) -> None:
        runner_fixture_id = f"_{self._loop_scope}_scoped_runner"
        if runner_fixture_id not in self.fixturenames:
            self.fixturenames.append(runner_fixture_id)
>       return super().setup()
               ^^^^^^^^^^^^^^^

.venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:458: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

mock_embedding_service = <AsyncMock id='4940977440'>
mock_vector_store = <AsyncMock id='4912685872'>
mock_metadata_store = <AsyncMock id='4905758656'>

    @pytest.fixture
    def mock_services(mock_embedding_service, mock_vector_store, mock_metadata_store):
        """Create mock service container with core services."""
>       return ServiceContainer(
            embedding_service=mock_embedding_service,
            vector_store=mock_vector_store,
            metadata_store=mock_metadata_store,
            code_indexer=None,
            git_analyzer=None,
            searcher=None,
        )
E       TypeError: ServiceContainer.__init__() got an unexpected keyword argument 'embedding_service'

tests/server/tools/conftest.py:43: TypeError
=============================== warnings summary ===============================
tests/clustering/test_clusterer.py: 208 warnings
tests/clustering/test_experience.py: 22 warnings
  /Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006/.venv/lib/python3.12/site-packages/sklearn/utils/deprecation.py:132: FutureWarning: 'force_all_finite' was renamed to 'ensure_all_finite' in 1.6 and will be removed in 1.8.
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
ERROR tests/server/tools/test_code.py::test_index_codebase_not_available - TypeError: ServiceContainer.__init__() got an unexpected keyword argument 'embedding_service'
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
==== 298 passed, 55 deselected, 230 warnings, 1 error in 144.35s (0:02:24) =====

=== Test Summary ===
Total: 299 | Passed: 298 | Failed: 0 | Errors: 1 | Skipped: 0
Duration: 144.35s
Test results logged to database

FAIL: Tests failed
âœ— Tests pass: FAIL

--- Gate: Linter clean ---
=== Running Linter ===
Directory: /Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006

Detected: Python
Running: ruff check
I001 [*] Import block is un-sorted or un-formatted
  --> tests/server/test_main.py:3:1
   |
 1 |   """Tests for server main module."""
 2 |
 3 | / import pytest
 4 | |
 5 | | from learning_memory_server.embedding import (
 6 | |     EmbeddingService,
 7 | |     initialize_registry,
 8 | |     get_semantic_embedder,
 9 | | )
10 | | from learning_memory_server.server.config import ServerSettings
11 | | from learning_memory_server.server.main import create_server
   | |____________________________________________________________^
   |
help: Organize imports

Found 1 error.
[*] 1 fixable with the `--fix` option.

FAIL: Linter errors found
âœ— Linter clean: FAIL

--- Gate: Type check clean ---
=== Running Type Checker ===
Directory: /Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006

Detected: Python
Running: mypy --strict (via uv run)
Success: no issues found in 61 source files

PASS: Type check clean
âœ“ Type check clean: PASS

--- Gate: No untracked TODOs ---
=== Checking for Untracked TODOs ===
Directory: /Users/elliotmilco/Documents/GitHub/clams/.worktrees/SPEC-006

No TODO comments found

PASS: No untracked TODOs
âœ“ No untracked TODOs: PASS

==========================================
GATE RESULT: FAIL

Fix the failing gates before proceeding.
